import{A,S as b,b as _,w as P,c as C,d as w,C as I,a as B,I as L,W as F}from"./NavigationView-B85skvgP.js";import{j as e}from"./createSvgIcon-BAyG150Y.js";import{A as t}from"./AdminComponentEasyAccessSet__loadShare___mf_0_mui_mf_1_material__loadShare__-DP1_LQ8a.js";import{V as D,a as q,I as M}from"./VisibilityOff-Bj1py224.js";import{R}from"./AdminComponentEasyAccessSet__loadShare__react__loadShare__-BWvOyvAg.js";import{A as y}from"./AdminComponentEasyAccessSet__loadShare___mf_0_iobroker_mf_1_adapter_mf_2_react_mf_2_v5__loadShare__-ChLGBbzW.js";import{T as S}from"./Tooltip-QmnnkgNQ.js";import"./index-BCpyQc2W.js";import"./_commonjsHelpers-CE1G-McA.js";import"./AdminComponentEasyAccessSet__mf_v__runtimeInit__mf_v__-DmMtQNcK.js";import"./Clear-jM7oAHDI.js";import"./useTheme-Cq43vfiC.js";import"./defaultTheme-BKgYrozm.js";import"./Grow-DxyKUkMA.js";class E extends R.Component{static defaultProps={widthPercent:30};aliveTimeout;constructor(i){super(i),this.state={available:[],selectedTopic:"",added:[],assignments:i.currentAssignments||[],pagesMap:{},isCollapsed:!1,isLoading:{},lastLoadTime:{},focusReceived:{}}}checkAlive(){if(!this.props.oContext||!this.props.oContext.socket){this.aliveTimeout=setTimeout(()=>this.checkAlive(),5e3);return}this.aliveTimeout=setTimeout(()=>this.checkAlive(),5e3)}componentWillUnmount(){this.aliveTimeout&&clearTimeout(this.aliveTimeout)}async componentDidMount(){this.checkAlive(),await this.loadPanels(!1),await this.applyAssignmentsFromProps(this.props.currentAssignments||[])}async applyAssignmentsFromProps(i){var x;const a=(i||[]).map(u=>this.state.available.find(j=>j.panelTopic===u.topic)||{panelTopic:u.topic,friendlyName:u.topic}),l=this.state.selectedAddedTopic,c=a.find(u=>u.panelTopic===l)?l:(x=a[0])==null?void 0:x.panelTopic;this.setState({assignments:i,added:a,selectedAddedTopic:c,selectedTopic:""});const r=a.map(u=>this.loadPagesForPanel(u.panelTopic,!0));await Promise.all(r)}componentDidUpdate(i){if(i.uniqueName!==this.props.uniqueName){const a=this.props.currentAssignments||[];this.props.uniqueName&&this.setState(l=>({focusReceived:{...l.focusReceived,[this.props.uniqueName]:!0}})),this.loadPanels(!1).then(()=>{this.applyAssignmentsFromProps(a)})}else if(i.currentAssignments!==this.props.currentAssignments&&this.props.currentAssignments){const a=this.props.currentAssignments||[];this.applyAssignmentsFromProps(a)}}async loadPanels(i=!0){try{let a=[];if(this.props.fetchPanels)a=await this.props.fetchPanels();else if(this.props.oContext&&this.props.oContext.socket){const l=this.props.oContext.instance??"0",s=`${A}.${l}`;try{const c=await this.props.oContext.socket.sendTo(s,b,null);Array.isArray(c)?a=c:c&&Array.isArray(c.result)&&(a=c.result)}catch(c){console.error("[NavigationAssignmentPanel] sendTo failed",{target:s,cmd:b,error:c})}}this.setState({available:a,selectedTopic:""})}catch{this.setState({available:[],selectedTopic:""})}}doAddSelected=()=>{const{selectedTopic:i,available:a,added:l}=this.state;if(!i)return;const s=a.find(x=>x.panelTopic===i);if(!s||l.find(x=>x.panelTopic===s.panelTopic))return;const c=[...l,s],r=[...this.state.assignments,{topic:s.panelTopic}];this.setState({added:c,assignments:r,selectedTopic:""}),this.loadPagesForPanel(s.panelTopic),this.props.onAssign&&this.props.uniqueName&&this.props.onAssign(this.props.uniqueName,r)};doRemoveSelected=()=>{const{added:i}=this.state;if(!i.length)return;const a=i.slice(0,-1),l=this.state.assignments.slice(0,-1);this.setState({added:a,assignments:l}),this.props.onAssign&&this.props.uniqueName&&this.props.onAssign(this.props.uniqueName,l)};selectAdded=i=>{this.setState({selectedAddedTopic:i}),this.loadPagesForPanel(i,!0)};async loadPagesForPanel(i,a=!1){var u,T,j;if(!i)return;const l=Date.now(),s=this.state.lastLoadTime[i]||0,c=this.state.isLoading[i],r=!!this.state.pagesMap[i],x=a||!r||l-s>6e4;if(c||!x&&r){console.log("[NavigationAssignmentPanel] Skipping loadPagesForPanel",{topic:i,isCurrentlyLoading:c,hasBeenLoaded:r,needsReload:x,forceReload:a,timeSinceLastLoad:l-s});return}this.setState(g=>({isLoading:{...g.isLoading,[i]:!0},lastLoadTime:{...g.lastLoadTime,[i]:l}}));try{console.log("[NavigationAssignmentPanel] Starting loadPagesForPanel",{topic:i,hasSocket:!!((u=this.props.oContext)!=null&&u.socket)});let g=[],n=!1;if((T=this.props.oContext)!=null&&T.socket){const o=this.props.oContext.instance??"0",d=`${A}.${o}`,h={panelTopic:i};try{const m=new Promise((v,N)=>{setTimeout(()=>N(new Error("sendTo timeout after 2 seconds")),2e3)}),p=this.props.oContext.socket.sendTo(d,_,h),f=await Promise.race([p,m]);Array.isArray(f)?(g=f,n=!0):f&&Array.isArray(f.result)&&(g=f.result,n=!0),console.log("[NavigationAssignmentPanel] sendTo successful",{topic:i,pages:g})}catch(m){console.warn("[NavigationAssignmentPanel] sendTo failed or timed out",{target:d,cmd:_,payload:h,error:m})}}if(!n&&!((j=this.props.oContext)!=null&&j.socket)&&(console.log("[NavigationAssignmentPanel] Retrying in 1 second due to no socket..."),await new Promise(o=>setTimeout(o,1e3)),this.setState(o=>({isLoading:{...o.isLoading,[i]:!1}})),!this.state.focusReceived[i]))return this.setState(o=>({focusReceived:{...o.focusReceived,[i]:!0}})),this.loadPagesForPanel(i,!0);this.setState(o=>({pagesMap:{...o.pagesMap,[i]:g},isLoading:{...o.isLoading,[i]:!1}})),console.log("[NavigationAssignmentPanel] loadPagesForPanel completed",{topic:i,success:n,pagesCount:g.length,pages:g})}catch(g){console.error("[NavigationAssignmentPanel] loadPagesForPanel error",{topic:i,error:g}),this.setState(n=>({isLoading:{...n.isLoading,[i]:!1}}))}}setNavigationForSelected=i=>{const{selectedAddedTopic:a,assignments:l}=this.state;if(!a)return;const s=l.findIndex(u=>u.topic===a),c=[...l],r=l[s],x={topic:a,navigation:{...r==null?void 0:r.navigation,...i}};s>=0?c[s]=x:c.push(x),this.setState({assignments:c}),this.props.onAssign&&this.props.uniqueName&&this.props.onAssign(this.props.uniqueName,c)};getNavValue=(i,a)=>{var c;if(!i)return"";const l=this.state.assignments.find(r=>r.topic===i);return((c=l==null?void 0:l.navigation)==null?void 0:c[a])||""};togglePanel=()=>{const i=this.state.isCollapsed;this.setState(a=>({isCollapsed:!a.isCollapsed})),i&&this.applyAssignmentsFromProps(this.props.currentAssignments||[])};render(){const{widthPercent:i}=this.props,{isCollapsed:a}=this.state,l=this.state.selectedAddedTopic?this.state.pagesMap[this.state.selectedAddedTopic]??[]:[];return console.log("[NavigationAssignmentPanel] Render state:",{selectedAddedTopic:this.state.selectedAddedTopic,assignments:this.state.assignments,pages:l,pagesMap:this.state.pagesMap}),e.jsxs(t.Box,{sx:{position:{xs:"static",md:"absolute"},right:{xs:"auto",md:0},top:{xs:"auto",md:0},height:{xs:"auto",md:"100%"},width:{xs:"100%",md:a?"10px":`${i}%`},minHeight:{xs:a?"50px":"auto",md:"auto"},transition:"width 240ms ease, min-height 240ms ease",backgroundColor:"background.default",border:{xs:"2px solid",md:"none"},borderLeft:{xs:"none",md:"2px solid"},borderTop:{xs:"none",md:"2px solid"},borderColor:"secondary.main",borderRadius:{xs:1,md:0},overflow:{xs:"hidden",md:"visible"},display:"flex",flexDirection:"column",zIndex:20,mt:{xs:2,md:0}},children:[e.jsx(t.Box,{sx:{display:{xs:"none",md:"flex"},position:"absolute",left:"-20px",top:"50%",transform:"translateY(-50%)",width:"20px",height:"60px",backgroundColor:"secondary.main",borderRadius:"4px 0 0 4px",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:21,"&:hover":{backgroundColor:"secondary.dark"}},onClick:this.togglePanel,children:e.jsx(t.Typography,{sx:{color:"secondary.contrastText",fontSize:"14px",fontWeight:"bold",transform:"rotate(-90deg)",whiteSpace:"nowrap"},children:a?"⏶":"⏷"})}),e.jsx(t.Box,{sx:{display:{xs:"flex",md:"none"},alignItems:"center",justifyContent:"center",p:1,backgroundColor:"secondary.main",color:"secondary.contrastText",borderRadius:"4px 4px 0 0"},children:e.jsx(t.Typography,{variant:"subtitle2",sx:{fontWeight:600},children:y.I18n.t("navigation_panel")})}),e.jsxs(t.Box,{sx:{p:1,height:"100%",display:{xs:"flex",md:a?"none":"flex"},flexDirection:"column",width:{xs:"100%",md:a?"0%":"100%"},overflow:"hidden",transition:{xs:"none",md:"width 240ms ease"}},children:[e.jsx(t.Typography,{variant:"h6",sx:{mb:1,fontWeight:600,color:"primary.main",fontSize:"1rem",display:{xs:"none",md:"block"}},children:y.I18n.t("navigation_panel")}),e.jsxs(t.Box,{sx:{display:"flex",gap:1,alignItems:"center",mb:1},children:[e.jsxs(t.Select,{size:"small",variant:"standard",value:this.state.selectedTopic,onOpen:()=>{this.loadPanels()},onChange:s=>this.setState({selectedTopic:String(s.target.value)}),sx:{flex:1,backgroundColor:"transparent",minHeight:40,"& .MuiSelect-select":{backgroundColor:"transparent",display:"flex",alignItems:"center",height:40}},displayEmpty:!0,children:[e.jsx(t.MenuItem,{value:"",children:e.jsx("em",{children:"—"})}),this.state.available.map(s=>e.jsx(t.MenuItem,{value:s.panelTopic,children:s.friendlyName},s.panelTopic))]}),e.jsx(t.Button,{size:"small",variant:"contained",sx:{minWidth:32,padding:"4px 8px"},onClick:this.doAddSelected,disabled:!this.state.selectedTopic,children:"+"})]}),e.jsx(t.Box,{children:this.state.added.length===0?e.jsx(t.Typography,{variant:"body2",color:"text.secondary",children:y.I18n.t("No panels added")}):e.jsx("div",{style:{overflow:"auto"},children:e.jsx(t.List,{dense:!0,children:this.state.added.map(s=>e.jsx(t.ListItem,{component:"div",children:e.jsx(t.ListItemButton,{selected:this.state.selectedAddedTopic===s.panelTopic,onClick:()=>this.selectAdded(s.panelTopic),children:e.jsx(t.ListItemText,{primary:s.friendlyName})})},s.panelTopic))})})}),e.jsx(t.Box,{sx:{display:"flex",gap:1,justifyContent:"flex-end",mt:1},children:e.jsx(t.Button,{size:"small",color:"error",variant:"contained",onClick:this.doRemoveSelected,disabled:this.state.added.length===0,sx:{minWidth:32,padding:"4px 8px"},children:"-"})}),e.jsx(t.Divider,{sx:{my:1}}),e.jsxs(t.Box,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:1,mt:1},children:[e.jsxs(t.Box,{children:[e.jsx(t.Box,{sx:{display:"flex",alignItems:"center",mb:.5},children:e.jsx(S,{title:y.I18n.t("nav_prev_tooltip"),children:e.jsx(t.Typography,{variant:"caption",color:"text.secondary",sx:{mr:.5},children:"prev"})})}),e.jsxs(t.Select,{size:"small",displayEmpty:!0,"aria-label":"prev",value:this.getNavValue(this.state.selectedAddedTopic,"prev")||"",onOpen:()=>{this.state.selectedAddedTopic&&this.loadPagesForPanel(this.state.selectedAddedTopic,!0)},onChange:s=>this.setNavigationForSelected({prev:String(s.target.value)||void 0}),sx:{width:"100%"},disabled:this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]||!1,endAdornment:this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]?e.jsx(t.Box,{sx:{display:"flex",alignItems:"center",pr:1},children:e.jsx(t.CircularProgress,{size:16})}):null,children:[e.jsx(t.MenuItem,{value:"",children:this.state.selectedAddedTopic?e.jsx("em",{children:"—"}):e.jsx("em",{children:y.I18n.t("select_panel_first")})}),l.filter(s=>s!==this.props.uniqueName).map(s=>e.jsx(t.MenuItem,{value:s,children:s},`prev-${s}`))]})]}),e.jsxs(t.Box,{children:[e.jsx(t.Box,{sx:{display:"flex",alignItems:"center",mb:.5},children:e.jsx(S,{title:y.I18n.t("nav_next_tooltip"),children:e.jsx(t.Typography,{variant:"caption",color:"text.secondary",sx:{mr:.5},children:"next"})})}),e.jsxs(t.Select,{size:"small",displayEmpty:!0,"aria-label":"next",value:this.getNavValue(this.state.selectedAddedTopic,"next")||"",onOpen:()=>{this.state.selectedAddedTopic&&this.loadPagesForPanel(this.state.selectedAddedTopic,!0)},onChange:s=>this.setNavigationForSelected({next:String(s.target.value)||void 0}),sx:{width:"100%"},disabled:this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]||!1,endAdornment:this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]?e.jsx(t.Box,{sx:{display:"flex",alignItems:"center",pr:1},children:e.jsx(t.CircularProgress,{size:16})}):null,children:[e.jsx(t.MenuItem,{value:"",children:this.state.selectedAddedTopic?e.jsx("em",{children:"—"}):e.jsx("em",{children:y.I18n.t("select_panel_first")})}),l.filter(s=>s!==this.props.uniqueName&&!s.startsWith("///")).map(s=>e.jsx(t.MenuItem,{value:s,children:s},`next-${s}`))]})]}),e.jsxs(t.Box,{children:[e.jsx(t.Typography,{variant:"caption",color:"text.secondary",sx:{mb:.5,display:"block"},children:"home"}),e.jsxs(t.Select,{size:"small",displayEmpty:!0,"aria-label":"home",value:this.getNavValue(this.state.selectedAddedTopic,"home")||"",onOpen:()=>{this.state.selectedAddedTopic&&this.loadPagesForPanel(this.state.selectedAddedTopic,!0)},onChange:s=>this.setNavigationForSelected({home:String(s.target.value)||void 0}),sx:{width:"100%"},disabled:this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]||!1,endAdornment:this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]?e.jsx(t.Box,{sx:{display:"flex",alignItems:"center",pr:1},children:e.jsx(t.CircularProgress,{size:16})}):null,children:[e.jsx(t.MenuItem,{value:"",children:e.jsx("em",{children:"—"})}),l.filter(s=>s!==this.props.uniqueName).map(s=>e.jsx(t.MenuItem,{value:s,children:s},`home-${s}`))]})]}),e.jsxs(t.Box,{children:[e.jsx(t.Typography,{variant:"caption",color:"text.secondary",sx:{mb:.5,display:"block"},children:"parent"}),e.jsxs(t.Select,{size:"small",displayEmpty:!0,"aria-label":"parent",value:this.getNavValue(this.state.selectedAddedTopic,"parent")||"",onOpen:()=>{this.state.selectedAddedTopic&&this.loadPagesForPanel(this.state.selectedAddedTopic,!0)},onChange:s=>this.setNavigationForSelected({parent:String(s.target.value)||void 0}),sx:{width:"100%"},disabled:this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]||!1,endAdornment:this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]?e.jsx(t.Box,{sx:{display:"flex",alignItems:"center",pr:1},children:e.jsx(t.CircularProgress,{size:16})}):null,children:[e.jsx(t.MenuItem,{value:"",children:e.jsx("em",{children:"—"})}),l.filter(s=>s!==this.props.uniqueName).map(s=>e.jsx(t.MenuItem,{value:s,children:s},`parent-${s}`))]})]})]}),(()=>{if(!this.state.selectedAddedTopic)return null;const s=this.getNavValue(this.state.selectedAddedTopic,"next"),c=this.getNavValue(this.state.selectedAddedTopic,"prev");return!s&&!c?e.jsxs(e.Fragment,{children:[e.jsx(t.Divider,{sx:{my:2}}),e.jsx(t.Typography,{variant:"caption",color:"text.secondary",sx:{fontStyle:"italic",lineHeight:1.4},children:y.I18n.t("nav_target_only_notice")})]}):null})()]})]})}}class O extends C.ConfigGeneric{_local=null;aliveTimeout;constructor(i){super(i);const a=C.ConfigGeneric.getValue(i.data,i.attr);this.state={...this.state,entries:Array.isArray(a)?a:[],confirmDeleteOpen:!1,confirmDeleteName:null,alive:!1}}checkAlive(){const i=this.props.oContext.instance??"0",a=this.props.oContext.socket;a&&typeof a.getState=="function"?a.getState(`system.adapter.${A}.${i}.alive`).then(l=>{this.setState({alive:!!(l!=null&&l.val)}),this.aliveTimeout=setTimeout(()=>this.checkAlive(),5e3)}):this.aliveTimeout=setTimeout(()=>this.checkAlive(),5e3)}componentWillUnmount(){this.aliveTimeout&&clearTimeout(this.aliveTimeout)}async componentDidMount(){this.checkAlive();const i=[];if(this.props.oContext&&this.props.oContext.socket&&this.state.alive){const a=this.props.oContext.instance??"0",l=`${A}.${a}`;try{const s=await this.props.oContext.socket.sendTo(l,w,null);let c=[];Array.isArray(s)?c=s:s&&Array.isArray(s.result)&&(c=s.result);for(const r of c)i.push(r)}catch{}}this.setState({pagesList:Array.from(new Set(i))})}renderItem(i,a,l){var g;const s=this.state.entries||[],c=Array.from(new Set(s.map(n=>n.uniqueName))).filter(Boolean);this._local||(this._local={newName:"",selected:c[0]||"",showPin:!1});const r=this._local,x=()=>{const n=(r.newName||"").trim();if(!n)return;const o={card:"cardAlarm",uniqueName:n,headline:n,button1:"",button2:"",button3:"",button4:"",pin:0},d=[...s,o];this.setState({entries:d}),this.onChange(this.props.attr,d),r.newName="",r.selected=n},u=()=>{const n=r.selected;n&&this.setState({confirmDeleteOpen:!0,confirmDeleteName:n})},T=()=>{this.setState({confirmDeleteOpen:!1,confirmDeleteName:null})},j=()=>{const n=this.state.confirmDeleteName;if(!n){T();return}const o=s.filter(h=>h.uniqueName!==n);this.setState({entries:o,confirmDeleteOpen:!1,confirmDeleteName:null}),this.onChange(this.props.attr,o);const d=Array.from(new Set(o.map(h=>h.uniqueName))).filter(Boolean);r.selected=d[0]||"",this.setState({})};return e.jsxs(t.Box,{sx:{height:"calc(100vh - 64px)",display:"flex",flexDirection:{xs:"column",md:"row"},p:1},children:[e.jsxs(t.Box,{sx:{width:{xs:"100%",md:"20%"},pr:{xs:0,md:1},display:"flex",flexDirection:"column",gap:1},children:[e.jsx(t.Typography,{variant:"h6",sx:{mb:1,fontWeight:600,color:"primary.main",fontSize:"1rem"},children:this.getText("pages")}),e.jsx(t.Paper,{sx:{p:1,backgroundColor:"transparent"},elevation:0,children:e.jsxs(t.Box,{sx:{display:"flex",gap:1},children:[e.jsx(t.TextField,{"aria-label":"new-name",label:this.getText("new_page"),value:r.newName,onChange:n=>{r.newName=n.target.value,this.setState({})},variant:"standard",placeholder:this.getText("New item"),InputProps:{sx:{backgroundColor:"transparent",px:1}},sx:{flex:1,"& .MuiInput-underline:before":{borderBottomColor:"primary.main"},"& .MuiInput-underline:hover:before":{borderBottomColor:"primary.main"},"& .MuiInput-underline:after":{borderBottomColor:"primary.main"},"& .MuiInputLabel-root":{color:"primary.main"},"& .MuiInputLabel-root.Mui-focused":{color:"primary.main"}}}),e.jsx(t.Button,{size:"small",variant:"contained",onClick:x,disabled:(()=>{const n=(r.newName||"").trim();return!n||c.includes(n)})(),children:"+"})]})}),e.jsx(t.Paper,{sx:{overflow:"auto",p:1,backgroundColor:"transparent"},elevation:0,children:c.length===0?e.jsx(t.Typography,{variant:"body2",color:"text.secondary",children:this.getText("No items")}):c.map(n=>e.jsx(t.Box,{onClick:()=>{r.selected=n,this.setState({})},sx:{p:1,borderRadius:1,cursor:"pointer",backgroundColor:r.selected===n?"action.selected":"transparent",mb:.5},children:e.jsx(t.Typography,{variant:"body2",children:n})},n))}),e.jsx(t.Box,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(t.Button,{size:"small",color:"error",variant:"outlined",onClick:u,disabled:!r.selected,children:"-"})}),e.jsx(t.Divider,{sx:{my:1}}),e.jsx(t.Box,{sx:{mb:2},children:e.jsx("a",{href:"https://github.com/ticaki/ioBroker.nspanel-lovelace-ui/wiki/pageUnlock",target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none",color:"inherit",fontSize:"0.875rem"},children:e.jsx(t.Typography,{variant:"body2",sx:{color:"primary.main",textDecoration:"underline",cursor:"pointer","&:hover":{opacity:.8}},children:this.getText("documentation")})})})]}),e.jsx(I,{open:!!this.state.confirmDeleteOpen,onClose:T,onConfirm:j,title:this.getText("unlock_delete_confirm_title"),description:this.getText("unlock_delete_confirm_text")+(this.state.confirmDeleteName?`: ${this.state.confirmDeleteName}`:""),cancelText:this.getText("Cancel"),confirmText:this.getText("Delete"),ariaTitleId:"unlock-delete-confirm-title",ariaDescId:"unlock-delete-confirm-description"}),e.jsxs(t.Box,{sx:{width:{xs:"100%",md:"90%"},pl:{xs:0,md:2},mt:{xs:2,md:0},display:"flex",flexDirection:{xs:"column",md:"row"},gap:1,position:"relative"},children:[e.jsx(t.Box,{sx:{width:{xs:"100%",md:"95%"},borderLeft:{xs:"none",md:"1px solid"},borderColor:"divider"},children:e.jsx(t.Paper,{sx:{height:"100%",p:2},elevation:1,children:r.selected?e.jsx(t.Box,{children:(()=>{const n=r.selected,o=s.find(d=>d.uniqueName===n);return o?e.jsxs(e.Fragment,{children:[e.jsx(t.Box,{sx:{mb:1,p:1,borderRadius:1,backgroundColor:"action.hover"},children:e.jsx(t.TextField,{fullWidth:!0,variant:"standard",type:"text",label:this.getText("unlock_unique_label"),value:n,onChange:d=>{const h=d.target.value;if(!h.trim())return;const m=s.map(p=>p.uniqueName===n?{...p,uniqueName:h}:p);this.setState({entries:m}),this.onChange(this.props.attr,m),r.selected=h},InputProps:{sx:{backgroundColor:"transparent",px:1,fontWeight:600,width:"50%"}}})}),e.jsx(t.Box,{sx:{mb:1},children:e.jsxs(t.FormControl,{component:"fieldset",children:[e.jsx(t.Typography,{variant:"subtitle2",sx:{mb:1},children:this.getText("unlock_type")}),e.jsxs(t.RadioGroup,{row:!0,value:(o==null?void 0:o.alarmType)||"",onChange:(d,h)=>{const m=s.map(p=>p.uniqueName===n?{...p,alarmType:h}:p);this.setState({entries:m}),this.onChange(this.props.attr,m)},children:[e.jsx(t.FormControlLabel,{value:"alarm",control:e.jsx(t.Radio,{}),label:this.getText("unlock_alarm")}),e.jsx(t.FormControlLabel,{value:"unlock",control:e.jsx(t.Radio,{}),label:this.getText("unlock_unlock")})]})]})}),e.jsx(t.TextField,{fullWidth:!0,variant:"standard",type:"text",autoComplete:"off",label:this.getText("unlock_headline"),value:o.headline??"",onChange:d=>{const h=d.target.value,m=s.map(p=>p.uniqueName===n?{...p,headline:h}:p);this.setState({entries:m}),this.onChange(this.props.attr,m)},InputProps:{sx:{backgroundColor:"transparent",px:1,width:"50%"}},sx:{mb:2}}),e.jsx(t.Box,{sx:{mt:2},children:e.jsx(t.TextField,{variant:"standard",label:this.getText("unlock_pin"),type:r.showPin?"text":"password",value:o.pin!==void 0&&o.pin!==null?String(o.pin):"",onChange:d=>{const m=d.target.value.replace(/[^0-9]/g,""),p=m?parseInt(m,10):0,f=s.map(v=>v.uniqueName===n?{...v,pin:p}:v);this.setState({entries:f}),this.onChange(this.props.attr,f)},InputProps:{sx:{backgroundColor:"transparent",px:1},endAdornment:e.jsx(t.InputAdornment,{position:"end",children:e.jsx(t.IconButton,{"aria-label":r.showPin?"hide-pin":"show-pin",onClick:()=>{r.showPin=!r.showPin,this.setState({})},edge:"end",size:"small",children:r.showPin?e.jsx(D,{fontSize:"small"}):e.jsx(q,{fontSize:"small"})})})}})}),e.jsxs(t.Box,{sx:{mt:2},children:[e.jsx(t.FormControlLabel,{control:e.jsx(t.Checkbox,{checked:!!o.hidden,onChange:(d,h)=>{const m=s.map(p=>p.uniqueName===n?{...p,hidden:h}:p);this.setState({entries:m}),this.onChange(this.props.attr,m)}}),label:this.getText("unlock_hidden")}),e.jsx(t.Box,{sx:{mt:2},children:e.jsxs(t.FormControl,{component:"fieldset",children:[e.jsx(t.Typography,{variant:"subtitle2",sx:{mb:1},children:this.getText("unlock_alwaysOn")}),e.jsxs(t.RadioGroup,{row:!0,value:(o==null?void 0:o.alwaysOn)||"none",onChange:(d,h)=>{const m=s.map(p=>p.uniqueName===n?{...p,alwaysOn:h}:p);this.setState({entries:m}),this.onChange(this.props.attr,m)},children:[e.jsx(t.FormControlLabel,{value:"none",control:e.jsx(t.Radio,{}),label:this.getText("unlock_alwaysOn_none")}),e.jsx(t.FormControlLabel,{value:"always",control:e.jsx(t.Radio,{}),label:this.getText("unlock_alwaysOn_always")}),e.jsx(t.FormControlLabel,{value:"ignore",control:e.jsx(t.Radio,{}),label:this.getText("unlock_alwaysOn_ignore")})]})]})})]}),o.alarmType==="alarm"&&e.jsxs(t.Box,{sx:{mt:2},children:[e.jsx(t.Box,{sx:{display:"grid",gridTemplateColumns:"1fr",gap:2},children:[1,2,3,4].map(d=>{const h=`button${d}`;return e.jsxs(t.Box,{children:[e.jsx(t.Typography,{variant:"caption",color:"text.secondary",sx:{mb:.5},children:this.getText(`unlock_button${d}_label`)}),e.jsx(t.TextField,{fullWidth:!0,variant:"standard",placeholder:this.getText(`unlock_button${d}_placeholder`),value:o[h]??"",onChange:m=>{const p=m.target.value,f=s.map(v=>v.uniqueName===n?{...v,[h]:p}:v);this.setState({entries:f}),this.onChange(this.props.attr,f)},InputProps:{disableUnderline:!0,sx:{backgroundColor:"transparent",px:1,"& input::placeholder":{color:"text.disabled"}}}})]},d)})}),e.jsx(t.Box,{sx:{mt:1},children:e.jsx(t.FormControlLabel,{control:e.jsx(t.Checkbox,{checked:!!o.approved,onChange:(d,h)=>{const m=s.map(p=>p.uniqueName===n?{...p,approved:h}:p);this.setState({entries:m}),this.onChange(this.props.attr,m)}}),label:this.getText("unlock_approved")})})]}),o.alarmType==="unlock"&&e.jsxs(t.Box,{sx:{mt:2},children:[e.jsx(t.Typography,{variant:"caption",color:"text.secondary",sx:{mb:.5},children:this.getText("unlock_setnavi_hint")}),e.jsxs(t.Select,{variant:"standard",displayEmpty:!0,value:o.setNavi??"",onChange:d=>{const h=String(d.target.value),m=s.map(p=>p.uniqueName===n?{...p,setNavi:h}:p);this.setState({entries:m}),this.onChange(this.props.attr,m)},sx:{backgroundColor:"transparent",px:1,width:"60%"},children:[e.jsx(t.MenuItem,{value:"",children:e.jsx("em",{children:this.getText("unlock_setnavi_placeholder")})}),(this.state.pagesList||[]).filter(d=>typeof d=="string"&&!d.startsWith("///")&&d!==n).map(d=>e.jsx(t.MenuItem,{value:d,children:d},d)),o.setNavi&&o.setNavi!==n&&!(this.state.pagesList||[]).includes(o.setNavi)&&e.jsx(t.MenuItem,{value:o.setNavi,children:o.setNavi},`custom-${o.setNavi}`)]})]})]}):null})()}):e.jsxs(t.Box,{children:[e.jsx(t.Typography,{variant:"h6",children:this.getText("unlock_select_item")}),e.jsx(t.Box,{sx:{mt:2},children:e.jsx(t.Typography,{variant:"body2",color:"text.secondary",children:this.getText("unlock_select_description")})})]})})}),e.jsx(E,{widthPercent:30,uniqueName:r.selected,currentAssignments:((g=s.find(n=>n.uniqueName===r.selected))==null?void 0:g.navigationAssignment)||[],oContext:this.props.oContext,onAssign:(n,o)=>{const d=s.map(h=>h.uniqueName===n?{...h,navigationAssignment:o}:h);this.setState({entries:d}),this.onChange(this.props.attr,d)},children:e.jsx(t.Paper,{sx:{height:"100%",p:2,backgroundColor:"transparent"},elevation:0,children:e.jsxs(t.Box,{children:[e.jsx(t.Typography,{variant:"subtitle2",sx:{mb:1},children:this.getText("unlock_unique_label")}),e.jsx(t.Typography,{variant:"body1",sx:{fontWeight:600},children:r.selected||this.getText("unlock_select_item")}),e.jsx(M,{fontSize:"small",color:"action",sx:{mt:1}})]})})})]})]})}}const z=P(O),se={NavigationView:F,IconSelect:L,IconOverview:B,UnlockPage:z};export{se as default};
