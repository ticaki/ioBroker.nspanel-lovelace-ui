import{A as k,b as P,c as I,S as O,w as F,d as B,C as L,a as z,I as V,W as U}from"./NavigationView-BDzsQ2SK.js";import{j as e}from"./createSvgIcon-BAyG150Y.js";import{A as t}from"./AdminComponentEasyAccessSet__loadShare___mf_0_mui_mf_1_material__loadShare__-DP1_LQ8a.js";import{D as Y,V as G,a as H}from"./VisibilityOff-BA5BfaUG.js";import{R}from"./AdminComponentEasyAccessSet__loadShare__react__loadShare__-BWvOyvAg.js";import{A as N}from"./AdminComponentEasyAccessSet__loadShare___mf_0_iobroker_mf_1_adapter_mf_2_react_mf_2_v5__loadShare__-ChLGBbzW.js";import{T as E}from"./Tooltip-QmnnkgNQ.js";import{A as W}from"./AdminComponentEasyAccessSet__loadShare___mf_0_mui_mf_1_icons_mf_2_material__loadShare__-CmHE1aSA.js";import"./index-BCpyQc2W.js";import"./_commonjsHelpers-CE1G-McA.js";import"./AdminComponentEasyAccessSet__mf_v__runtimeInit__mf_v__-DmMtQNcK.js";import"./Clear-jM7oAHDI.js";import"./useTheme-Cq43vfiC.js";import"./defaultTheme-BKgYrozm.js";import"./Grow-DxyKUkMA.js";class q extends k.ConfigGeneric{static defaultProps={widthPercent:30};constructor(i){super(i),this.state={...this.state,available:[],selectedTopic:"",added:[],assignments:i.currentAssignments||[],pagesMap:{},alive:!1,isCollapsed:!1,isLoading:{},lastLoadTime:{},focusReceived:{},retryCount:{}}}componentWillUnmount(){if(this.props.oContext&&this.props.oContext.socket){const i=this.props.oContext.instance??"0";this.props.oContext.socket.unsubscribeState(`system.adapter.${P}.${i}.alive`,this.onAliveChanged)}}async componentDidMount(){if(super.componentDidMount(),this.props.oContext&&this.props.oContext.socket){const i=this.props.oContext.instance??"0",r=`system.adapter.${P}.${i}.alive`;try{const l=await this.props.oContext.socket.getState(r),a=!!(l!=null&&l.val);this.setState({alive:a}),await this.props.oContext.socket.subscribeState(r,this.onAliveChanged)}catch(l){console.error("[NavigationAssignmentPanel] Failed to get alive state or subscribe:",l),this.setState({alive:!1})}}await this.loadPanels(!1),await this.applyAssignmentsFromProps(this.props.currentAssignments||[])}onAliveChanged=(i,r)=>{const l=this.state.alive,a=r?!!r.val:!1;l!==a&&(this.setState({alive:a}),!l&&a&&this.state.assignments.length>0&&this.retryLoadingPagesForAssignments())};async applyAssignmentsFromProps(i){var o;const r=(i||[]).map(y=>this.state.available.find(w=>w.panelTopic===y.topic)||{panelTopic:y.topic,friendlyName:y.topic}).sort((y,_)=>y.friendlyName.localeCompare(_.friendlyName));console.log(`[NavigationAssignmentPanel] applyAssignmentsFromProps: available=${JSON.stringify(this.state.available)}, added=${JSON.stringify(r)}`);const l=this.state.selectedAddedTopic,c=r.find(y=>y.panelTopic===l)?l:(o=r[0])==null?void 0:o.panelTopic;this.setState({assignments:i,added:r,selectedAddedTopic:c,selectedTopic:""});const s=r.map(y=>this.loadPagesForPanel(y.panelTopic,!0));await Promise.all(s)}componentDidUpdate(i){if(i.uniqueName!==this.props.uniqueName){const r=this.props.currentAssignments||[];this.props.uniqueName&&this.setState(l=>({focusReceived:{...l.focusReceived,[this.props.uniqueName]:!0}})),this.loadPanels(!1).then(()=>{this.applyAssignmentsFromProps(r)})}else if(i.currentAssignments!==this.props.currentAssignments&&this.props.currentAssignments){const r=this.props.currentAssignments||[];this.applyAssignmentsFromProps(r)}}async loadPanels(i=!0){var r;try{let l=[];this.props.fetchPanels?l=await this.props.fetchPanels():(r=this.props.data)!=null&&r.panels&&(l=(this.props.data.panels||[]).map(a=>({panelTopic:a.topic,friendlyName:a.name||a.topic}))),await new Promise(a=>this.setState({available:l,selectedTopic:""},()=>a()))}catch{this.setState({available:[],selectedTopic:""})}}doAddSelected=()=>{const{selectedTopic:i,available:r,added:l}=this.state;if(!i)return;let a=r.find(o=>o.panelTopic===i);if(!a&&i===I&&(a={panelTopic:I,friendlyName:`(${N.I18n.t("all")||"All"})`}),!a||l.find(o=>o.panelTopic===a.panelTopic))return;const c=[...l,a],s=[...this.state.assignments,{topic:a.panelTopic}];this.setState({added:c,assignments:s,selectedTopic:""}),this.loadPagesForPanel(a.panelTopic),this.props.onAssign&&this.props.uniqueName&&this.props.onAssign(this.props.uniqueName,s)};doRemoveSelected=()=>{const{added:i,selectedAddedTopic:r}=this.state;if(i.length)if(r){const l=i.filter(o=>o.panelTopic!==r),a=this.state.assignments.filter(o=>o.topic!==r),c=i.findIndex(o=>o.panelTopic===r);let s;if(l.length>0){const o=l[c]??l[c-1]??l[0];s=o==null?void 0:o.panelTopic}else s=void 0;this.setState({added:l,assignments:a,selectedAddedTopic:s}),this.props.onAssign&&this.props.uniqueName&&this.props.onAssign(this.props.uniqueName,a)}else{const l=i.slice(0,-1),a=this.state.assignments.slice(0,-1),c=l.length?l[l.length-1].panelTopic:void 0;this.setState({added:l,assignments:a,selectedAddedTopic:c}),this.props.onAssign&&this.props.uniqueName&&this.props.onAssign(this.props.uniqueName,a)}};selectAdded=i=>{this.setState({selectedAddedTopic:i}),this.loadPagesForPanel(i,!0)};retryLoadingPagesForAssignments(){const i=this.state.assignments.map(r=>r.topic);for(const r of i)this.loadPagesForPanel(r,!0)}async loadPagesForPanel(i,r=!1){var y,_;if(!i)return;if(!this.state.alive){console.log(`[NavigationAssignmentPanel] Adapter not alive, skipping pages load for ${i}`);return}const l=Date.now(),a=this.state.lastLoadTime[i]||0,c=this.state.isLoading[i],s=!!this.state.pagesMap[i],o=r||!s||l-a>6e4;if(!(c||!o&&s)){this.setState(w=>({isLoading:{...w.isLoading,[i]:!0},lastLoadTime:{...w.lastLoadTime,[i]:l}}));try{let w=[],h=!1;if((y=this.props.oContext)!=null&&y.socket){const n=this.props.oContext.instance??"0",d=`${P}.${n}`,m={panelTopic:i};try{const p=new Promise((g,x)=>{setTimeout(()=>x(new Error("sendTo timeout after 2 seconds")),2e3)}),b=this.props.oContext.socket.sendTo(d,O,m),T=await Promise.race([b,p]);Array.isArray(T)?(w=T,h=!0):T&&Array.isArray(T.result)&&(w=T.result,h=!0),console.log("[NavigationAssignmentPanel] sendTo successful",{topic:i,pages:w})}catch(p){console.warn("[NavigationAssignmentPanel] sendTo failed or timed out",{target:d,cmd:O,payload:m,error:p})}}if(h&&w.length===0){const n=this.state.retryCount[i]||0,d=3,m=2e3;if(n<d){console.log(`[NavigationAssignmentPanel] Got empty array for ${i}, retrying in ${m}ms (attempt ${n+1}/${d})`),this.setState(p=>({retryCount:{...p.retryCount,[i]:n+1}})),setTimeout(()=>{this.setState(p=>({isLoading:{...p.isLoading,[i]:!1}})),this.loadPagesForPanel(i,!0)},m);return}console.log(`[NavigationAssignmentPanel] Max retries reached for ${i}, accepting empty result`),this.setState(p=>({retryCount:{...p.retryCount,[i]:0}}))}else h&&w.length>0&&this.setState(n=>({retryCount:{...n.retryCount,[i]:0}}));if(!h&&!((_=this.props.oContext)!=null&&_.socket)&&(await new Promise(n=>setTimeout(n,1e3)),this.setState(n=>({isLoading:{...n.isLoading,[i]:!1}})),!this.state.focusReceived[i]))return this.setState(n=>({focusReceived:{...n.focusReceived,[i]:!0}})),this.loadPagesForPanel(i,!0);this.setState(n=>({pagesMap:{...n.pagesMap,[i]:w},isLoading:{...n.isLoading,[i]:!1}}))}catch(w){console.error("[NavigationAssignmentPanel] loadPagesForPanel error",{topic:i,error:w}),this.setState(h=>({isLoading:{...h.isLoading,[i]:!1}}))}}}setNavigationForSelected=i=>{const{selectedAddedTopic:r,assignments:l}=this.state;if(!r)return;const a=l.findIndex(y=>y.topic===r),c=[...l],s=l[a],o={topic:r,navigation:{...s==null?void 0:s.navigation,...i}};a>=0?c[a]=o:c.push(o),this.setState({assignments:c}),this.props.onAssign&&this.props.uniqueName&&this.props.onAssign(this.props.uniqueName,c)};getNavValue=(i,r)=>{var c;if(!i)return"";const l=this.state.assignments.find(s=>s.topic===i);return((c=l==null?void 0:l.navigation)==null?void 0:c[r])||""};togglePanel=()=>{const i=this.state.isCollapsed;this.setState(r=>({isCollapsed:!r.isCollapsed})),i&&this.applyAssignmentsFromProps(this.props.currentAssignments||[])};renderItem(i,r,l){const{widthPercent:a}=this.props,{isCollapsed:c}=this.state,s=this.state.selectedAddedTopic?this.state.pagesMap[this.state.selectedAddedTopic]??[]:[];return e.jsxs(t.Box,{sx:{position:{xs:"static",md:"absolute"},right:{xs:"auto",md:0},top:{xs:"auto",md:0},height:{xs:"auto",md:"100%"},width:{xs:"100%",md:c?"10px":`${a}%`},minHeight:{xs:c?"50px":"auto",md:"auto"},transition:"width 240ms ease, min-height 240ms ease",backgroundColor:"background.default",border:{xs:"2px solid",md:"none"},borderLeft:{xs:"none",md:"2px solid"},borderTop:{xs:"none",md:"2px solid"},borderColor:"secondary.main",borderRadius:{xs:1,md:0},overflow:{xs:"hidden",md:"visible"},display:"flex",flexDirection:"column",zIndex:20,mt:{xs:2,md:0}},children:[e.jsx(t.Box,{sx:{display:{xs:"none",md:"flex"},position:"absolute",left:"-20px",top:"50%",transform:"translateY(-50%)",width:"20px",height:"60px",backgroundColor:"secondary.main",borderRadius:"4px 0 0 4px",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:21,"&:hover":{backgroundColor:"secondary.dark"}},onClick:this.togglePanel,children:e.jsx(t.Typography,{sx:{color:"secondary.contrastText",fontSize:"14px",fontWeight:"bold",transform:"rotate(-90deg)",whiteSpace:"nowrap"},children:c?"⏶":"⏷"})}),e.jsx(t.Box,{sx:{display:{xs:"flex",md:"none"},alignItems:"center",justifyContent:"center",p:1,backgroundColor:"secondary.main",color:"secondary.contrastText",borderRadius:"4px 4px 0 0"},children:e.jsx(t.Typography,{variant:"subtitle2",sx:{fontWeight:600},children:N.I18n.t("navigation_panel")})}),e.jsxs(t.Box,{sx:{p:1,height:"100%",display:{xs:"flex",md:c?"none":"flex"},flexDirection:"column",width:{xs:"100%",md:c?"0%":"100%"},overflow:"hidden",transition:{xs:"none",md:"width 240ms ease"}},children:[e.jsx(t.Typography,{variant:"h6",sx:{mb:1,fontWeight:600,color:"primary.main",fontSize:"1rem",display:{xs:"none",md:"block"}},children:N.I18n.t("navigation_panel")}),e.jsxs(t.Box,{sx:{display:"flex",gap:1,alignItems:"center",mb:1},children:[e.jsxs(t.Select,{size:"small",variant:"standard",value:this.state.selectedTopic,onOpen:()=>{this.loadPanels()},onChange:o=>this.setState({selectedTopic:String(o.target.value)}),disabled:!this.state.alive,sx:{flex:1,backgroundColor:"transparent",minHeight:40,"& .MuiSelect-select":{backgroundColor:"transparent",display:"flex",alignItems:"center",height:40}},displayEmpty:!0,children:[e.jsx(t.MenuItem,{value:"",children:e.jsx("em",{children:"—"})}),!this.state.added.some(o=>o.panelTopic===I)&&e.jsx(t.MenuItem,{value:I,children:`(${N.I18n.t("all")||"All"})`}),this.state.available.filter(o=>!this.state.added.some(y=>y.panelTopic===o.panelTopic)).map(o=>e.jsx(t.MenuItem,{value:o.panelTopic,children:o.friendlyName},o.panelTopic))]}),e.jsx(t.Button,{size:"small",variant:"contained",sx:{minWidth:32,padding:"4px 8px"},onClick:this.doAddSelected,disabled:!this.state.selectedTopic||!this.state.alive,children:"+"})]}),e.jsx(t.Box,{children:this.state.added.length===0?e.jsx(t.Typography,{variant:"body2",color:"text.secondary",children:N.I18n.t("No panels added")}):e.jsx("div",{style:{overflow:"auto"},children:e.jsx(t.List,{dense:!0,children:this.state.added.map(o=>{const y=o.panelTopic,_=this.state.pendingDelete===y;return e.jsx(R.Fragment,{children:e.jsx(t.ListItem,{component:"div",disablePadding:!0,sx:{"&:hover .delete-icon":{opacity:1}},secondaryAction:e.jsx(t.IconButton,{className:"delete-icon",edge:"end","aria-label":"delete",size:"small",onClick:w=>{var h;if(w.stopPropagation(),!_)this.setState({pendingDelete:y}),setTimeout(()=>{this.state.pendingDelete===y&&this.setState({pendingDelete:void 0})},3e3);else{const n=this.state.added.filter(p=>p.panelTopic!==y),d=this.state.assignments.filter(p=>p.topic!==y),m=n.length>0?(h=n[0])==null?void 0:h.panelTopic:void 0;this.setState({added:n,assignments:d,selectedAddedTopic:m,pendingDelete:void 0}),this.props.onAssign&&this.props.uniqueName&&this.props.onAssign(this.props.uniqueName,d)}},sx:{color:_?"error.dark":"error.main",opacity:{xs:1,md:0},transition:"opacity 0.2s",backgroundColor:_?"error.main":"transparent","&:hover":{backgroundColor:_?"error.dark":"action.hover"}},children:e.jsx(Y,{fontSize:"small"})}),children:e.jsx(t.ListItemButton,{selected:this.state.selectedAddedTopic===y,onClick:()=>{this.selectAdded(y),this.setState({pendingDelete:void 0})},sx:{pr:6},children:e.jsx(t.ListItemText,{primary:y===I?`(${N.I18n.t("all")||"All"})`:o.friendlyName,sx:{flex:1,overflow:"hidden",textOverflow:"ellipsis"}})})})},y)})})})}),e.jsx(t.Divider,{sx:{my:1}}),e.jsxs(t.Box,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:1,mt:1},children:[e.jsxs(t.Box,{children:[e.jsx(t.Box,{sx:{display:"flex",alignItems:"center",mb:.5},children:e.jsx(E,{title:N.I18n.t("nav_prev_tooltip"),children:e.jsx(t.Typography,{variant:"caption",color:"text.secondary",sx:{mr:.5},children:"prev"})})}),e.jsxs(t.Select,{size:"small",displayEmpty:!0,"aria-label":"prev",value:this.getNavValue(this.state.selectedAddedTopic,"prev")||"",onOpen:()=>{this.state.selectedAddedTopic&&this.loadPagesForPanel(this.state.selectedAddedTopic,!0)},onChange:o=>this.setNavigationForSelected({prev:String(o.target.value)||void 0}),sx:{width:"100%"},disabled:!this.state.alive||this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]||!1,endAdornment:this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]?e.jsx(t.Box,{sx:{display:"flex",alignItems:"center",pr:1},children:e.jsx(t.CircularProgress,{size:16})}):null,children:[e.jsx(t.MenuItem,{value:"",children:this.state.selectedAddedTopic?e.jsx("em",{children:"—"}):e.jsx("em",{children:N.I18n.t("select_panel_first")})}),s.filter(o=>o!==this.props.uniqueName).map(o=>e.jsx(t.MenuItem,{value:o,children:o},`prev-${o}`))]})]}),e.jsxs(t.Box,{children:[e.jsx(t.Box,{sx:{display:"flex",alignItems:"center",mb:.5},children:e.jsx(E,{title:N.I18n.t("nav_next_tooltip"),children:e.jsx(t.Typography,{variant:"caption",color:"text.secondary",sx:{mr:.5},children:"next"})})}),e.jsxs(t.Select,{size:"small",displayEmpty:!0,"aria-label":"next",value:this.getNavValue(this.state.selectedAddedTopic,"next")||"",onOpen:()=>{this.state.selectedAddedTopic&&this.loadPagesForPanel(this.state.selectedAddedTopic,!0)},onChange:o=>this.setNavigationForSelected({next:String(o.target.value)||void 0}),sx:{width:"100%"},disabled:!this.state.alive||this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]||!1,endAdornment:this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]?e.jsx(t.Box,{sx:{display:"flex",alignItems:"center",pr:1},children:e.jsx(t.CircularProgress,{size:16})}):null,children:[e.jsx(t.MenuItem,{value:"",children:this.state.selectedAddedTopic?e.jsx("em",{children:"—"}):e.jsx("em",{children:N.I18n.t("select_panel_first")})}),s.filter(o=>o!==this.props.uniqueName&&!o.startsWith("///")).map(o=>e.jsx(t.MenuItem,{value:o,children:o},`next-${o}`))]})]}),e.jsxs(t.Box,{children:[e.jsx(t.Typography,{variant:"caption",color:"text.secondary",sx:{mb:.5,display:"block"},children:"home"}),e.jsxs(t.Select,{size:"small",displayEmpty:!0,"aria-label":"home",value:this.getNavValue(this.state.selectedAddedTopic,"home")||"",onOpen:()=>{this.state.selectedAddedTopic&&this.loadPagesForPanel(this.state.selectedAddedTopic,!0)},onChange:o=>this.setNavigationForSelected({home:String(o.target.value)||void 0}),sx:{width:"100%"},disabled:!this.state.alive||this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]||!1,endAdornment:this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]?e.jsx(t.Box,{sx:{display:"flex",alignItems:"center",pr:1},children:e.jsx(t.CircularProgress,{size:16})}):null,children:[e.jsx(t.MenuItem,{value:"",children:e.jsx("em",{children:"—"})}),s.filter(o=>o!==this.props.uniqueName).map(o=>e.jsx(t.MenuItem,{value:o,children:o},`home-${o}`))]})]}),e.jsxs(t.Box,{children:[e.jsx(t.Typography,{variant:"caption",color:"text.secondary",sx:{mb:.5,display:"block"},children:"parent"}),e.jsxs(t.Select,{size:"small",displayEmpty:!0,"aria-label":"parent",value:this.getNavValue(this.state.selectedAddedTopic,"parent")||"",onOpen:()=>{this.state.selectedAddedTopic&&this.loadPagesForPanel(this.state.selectedAddedTopic,!0)},onChange:o=>this.setNavigationForSelected({parent:String(o.target.value)||void 0}),sx:{width:"100%"},disabled:!this.state.alive||this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]||!1,endAdornment:this.state.selectedAddedTopic&&this.state.isLoading[this.state.selectedAddedTopic]?e.jsx(t.Box,{sx:{display:"flex",alignItems:"center",pr:1},children:e.jsx(t.CircularProgress,{size:16})}):null,children:[e.jsx(t.MenuItem,{value:"",children:e.jsx("em",{children:"—"})}),s.filter(o=>o!==this.props.uniqueName).map(o=>e.jsx(t.MenuItem,{value:o,children:o},`parent-${o}`))]})]}),e.jsx(t.Divider,{sx:{my:1}})]}),this.state.added.length>0?this.state.added.map(o=>{const y=o.panelTopic,_=this.state.added.some(g=>g.panelTopic===I),w=this.getNavValue(y,"next"),h=this.getNavValue(y,"prev"),n=this.getNavValue(y,"home"),d=this.getNavValue(y,"parent"),m=!!(w||h||n||d),p=y===I,b=!w&&!h,T=p?"nav_all_requires_prev_next":_?"nav_remove_from_all_notice":"nav_target_only_notice";return e.jsxs(t.Box,{"data-has-all":_,sx:{mt:2,mb:1},children:[e.jsxs(t.Box,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[e.jsx(t.Box,{sx:{width:10,height:10,borderRadius:"50%",bgcolor:m?"success.main":"error.main"}}),e.jsx(t.Typography,{variant:"subtitle2",sx:{fontWeight:600},children:y===I?`(${N.I18n.t("all")||"All"})`:o.friendlyName||y})]}),e.jsx(t.Box,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:["next","prev","parent","home"].map((g,x)=>{const f=this.getNavValue(y,g);return e.jsxs(R.Fragment,{children:[e.jsxs(t.Box,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(t.Typography,{variant:"caption",color:"text.secondary",children:N.I18n.t(g)||g}),e.jsx(t.Typography,{variant:"body2",children:f||e.jsx("em",{children:"—"})})]}),x<3&&e.jsx(t.Divider,{orientation:"vertical",flexItem:!0,sx:{height:18,mx:1}})]},`${y}-${g}`)})}),b?e.jsx(t.Box,{sx:{mt:1},children:e.jsx(t.Typography,{variant:"caption",color:"text.secondary",sx:{fontStyle:"italic"},children:N.I18n.t(T)})}):null]},`panel-summary-${y}`)}):null]})]})}}class Q extends k.ConfigGeneric{_local=null;pagesRetryTimeout;constructor(i){super(i);const r=k.ConfigGeneric.getValue(i.data,i.attr);this.state={...this.state,entries:Array.isArray(r)?r:[],confirmDeleteOpen:!1,confirmDeleteName:null,alive:!1,pagesRetryCount:0}}componentWillUnmount(){this.pagesRetryTimeout&&clearTimeout(this.pagesRetryTimeout);const i=this.props.oContext.instance??"0";this.props.oContext.socket.unsubscribeState(`system.adapter.${P}.${i}.alive`,this.onAliveChanged)}async componentDidMount(){super.componentDidMount();const i=this.props.oContext.instance??"0",r=`system.adapter.${P}.${i}.alive`;try{const l=await this.props.oContext.socket.getState(r),a=!!(l!=null&&l.val);this.setState({alive:a}),await this.props.oContext.socket.subscribeState(r,this.onAliveChanged),a&&await this.loadPagesList()}catch(l){console.error("[UnlockPage] Failed to get alive state or subscribe:",l),this.setState({alive:!1})}}onAliveChanged=(i,r)=>{const l=this.state.alive,a=r?!!r.val:!1;l!==a&&(this.setState({alive:a}),!l&&a&&(!this.state.pagesList||this.state.pagesList.length===0)&&this.loadPagesList(),l&&!a&&this.pagesRetryTimeout&&(clearTimeout(this.pagesRetryTimeout),this.pagesRetryTimeout=void 0))};async loadPagesList(){if(!this.state.alive){console.log("[UnlockPage] Adapter not alive, skipping pages load");return}const i=[];if(this.props.oContext&&this.props.oContext.socket){const r=this.props.oContext.instance??"0",l=`${P}.${r}`;try{const a=await this.props.oContext.socket.sendTo(l,B,null);let c=[];Array.isArray(a)?c=a:a&&Array.isArray(a.result)&&(c=a.result);for(const s of c)i.push(s);if(c.length===0){const s=this.state.pagesRetryCount||0,o=3e3;console.log(`[UnlockPage] Got empty pages array, retrying in ${o}ms (attempt ${s+1})`),this.setState({pagesRetryCount:s+1}),this.pagesRetryTimeout&&clearTimeout(this.pagesRetryTimeout),this.pagesRetryTimeout=setTimeout(()=>{this.state.alive?this.loadPagesList():console.log("[UnlockPage] Adapter went offline, cancelling pages retry")},o);return}else c.length>0&&(console.log(`[UnlockPage] Successfully loaded ${c.length} pages after ${this.state.pagesRetryCount||0} retries`),this.setState({pagesRetryCount:0}),this.pagesRetryTimeout&&(clearTimeout(this.pagesRetryTimeout),this.pagesRetryTimeout=void 0))}catch(a){const c=this.state.pagesRetryCount||0,s=3e3;console.log(`[UnlockPage] Error loading pages, retrying in ${s}ms (attempt ${c+1}): ${String(a)}`),this.setState({pagesRetryCount:c+1}),this.pagesRetryTimeout&&clearTimeout(this.pagesRetryTimeout),this.pagesRetryTimeout=setTimeout(()=>{this.state.alive?this.loadPagesList():console.log("[UnlockPage] Adapter went offline, cancelling pages retry after error")},s);return}}else{console.log("[UnlockPage] No socket available for sendTo");return}this.setState({pagesList:Array.from(new Set(i))})}renderItem(i,r,l){var w;const a=this.state.entries||[],c=Array.from(new Set(a.map(h=>h.uniqueName))).filter(Boolean);this._local||(this._local={newName:"",selected:c[0]||"",showPin:!1});const s=this._local,o=()=>{const h=(s.newName||"").trim();if(!h)return;const n={card:"cardAlarm",uniqueName:h,headline:h,button1:"",button2:"",button3:"",button4:"",button5:"",button6:"",button7:"",button8:"",pin:0},d=[...a,n];this.setState({entries:d}),this.onChange(this.props.attr,d),s.newName="",s.selected=h},y=()=>{this.setState({confirmDeleteOpen:!1,confirmDeleteName:null})},_=()=>{const h=this.state.confirmDeleteName;if(!h){y();return}const n=a.filter(m=>m.uniqueName!==h);this.setState({entries:n,confirmDeleteOpen:!1,confirmDeleteName:null}),this.onChange(this.props.attr,n);const d=Array.from(new Set(n.map(m=>m.uniqueName))).filter(Boolean);s.selected=d[0]||"",this.setState({})};return e.jsxs(t.Box,{sx:{height:"calc(100vh - 64px)",display:"flex",flexDirection:{xs:"column",md:"row"},p:1},children:[e.jsxs(t.Box,{sx:{width:{xs:"100%",md:"20%"},pr:{xs:0,md:1},display:"flex",flexDirection:"column",gap:1},children:[e.jsx(t.Typography,{variant:"h6",sx:{mb:1,fontWeight:600,color:"primary.main",fontSize:"1rem"},children:this.getText("pages")}),e.jsx(t.Paper,{sx:{p:1,backgroundColor:"transparent"},elevation:0,children:e.jsxs(t.Box,{sx:{display:"flex",gap:1},children:[e.jsx(t.TextField,{"aria-label":"new-name",label:this.getText("new_page"),value:s.newName,onChange:h=>{s.newName=h.target.value,this.setState({})},variant:"standard",placeholder:this.getText("New item"),InputProps:{sx:{backgroundColor:"transparent",px:1}},sx:{flex:1,"& .MuiInput-underline:before":{borderBottomColor:"primary.main"},"& .MuiInput-underline:hover:before":{borderBottomColor:"primary.main"},"& .MuiInput-underline:after":{borderBottomColor:"primary.main"},"& .MuiInputLabel-root":{color:"primary.main"},"& .MuiInputLabel-root.Mui-focused":{color:"primary.main"}}}),e.jsx(t.Button,{size:"small",variant:"contained",onClick:o,disabled:(()=>{const h=(s.newName||"").trim();return!h||c.includes(h)})(),children:"+"})]})}),e.jsx(t.Paper,{sx:{overflow:"auto",p:1,backgroundColor:"transparent"},elevation:0,children:c.length===0?e.jsx(t.Typography,{variant:"body2",color:"text.secondary",children:this.getText("No items")}):c.map(h=>e.jsxs(t.Box,{onClick:()=>{s.selected=h,this.setState({})},sx:{p:1,borderRadius:1,cursor:"pointer",backgroundColor:s.selected===h?"action.selected":"transparent",mb:.5,display:"flex",justifyContent:"space-between",alignItems:"center","&:hover .delete-icon":{opacity:1}},children:[e.jsx(t.Typography,{variant:"body2",sx:{flex:1,overflow:"hidden",textOverflow:"ellipsis"},children:h}),e.jsx(t.IconButton,{className:"delete-icon",edge:"end","aria-label":"delete",size:"small",onClick:n=>{n.stopPropagation(),s.selected=h,this.setState({confirmDeleteOpen:!0,confirmDeleteName:h})},sx:{color:"error.main",opacity:{xs:1,md:0},transition:"opacity 0.2s"},children:e.jsx(Y,{fontSize:"small"})})]},h))}),e.jsx(t.Divider,{sx:{my:1}}),e.jsx(t.Box,{sx:{mb:2},children:e.jsx("a",{href:"https://github.com/ticaki/ioBroker.nspanel-lovelace-ui/wiki/pageUnlock",target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none",color:"inherit",fontSize:"0.875rem"},children:e.jsx(t.Typography,{variant:"body2",sx:{color:"primary.main",textDecoration:"underline",cursor:"pointer","&:hover":{opacity:.8}},children:this.getText("documentation")})})})]}),e.jsx(L,{open:!!this.state.confirmDeleteOpen,onClose:y,onConfirm:_,title:this.getText("delete_confirm_title"),description:this.getText("delete_confirm_text")+(this.state.confirmDeleteName?`: ${this.state.confirmDeleteName}`:""),cancelText:this.getText("Cancel"),confirmText:this.getText("Delete"),ariaTitleId:"unlock-delete-confirm-title",ariaDescId:"unlock-delete-confirm-description"}),e.jsxs(t.Box,{sx:{width:{xs:"100%",md:"90%"},pl:{xs:0,md:2},mt:{xs:2,md:0},display:"flex",flexDirection:{xs:"column",md:"row"},gap:1,position:"relative"},children:[e.jsx(t.Box,{sx:{width:{xs:"100%",md:"95%"},borderLeft:{xs:"none",md:"1px solid"},borderColor:"divider"},children:e.jsx(t.Paper,{sx:{height:"100%",p:2},elevation:1,children:s.selected?e.jsx(t.Box,{children:(()=>{const h=s.selected,n=a.find(d=>d.uniqueName===h);return n?e.jsxs(e.Fragment,{children:[e.jsx(t.Box,{sx:{mb:1,p:1,borderRadius:1,backgroundColor:"action.hover"},children:e.jsx(t.TextField,{fullWidth:!0,variant:"standard",type:"text",label:this.getText("unique_label"),value:h,onChange:d=>{const m=d.target.value;if(!m.trim())return;const p=a.map(b=>b.uniqueName===h?{...b,uniqueName:m}:b);this.setState({entries:p}),this.onChange(this.props.attr,p),s.selected=m},InputProps:{sx:{backgroundColor:"transparent",px:1,fontWeight:600,width:"50%"}}})}),e.jsx(t.Box,{sx:{mb:1},children:e.jsxs(t.FormControl,{component:"fieldset",children:[e.jsx(t.Typography,{variant:"subtitle2",sx:{mb:1},children:this.getText("unlock_type")}),e.jsxs(t.RadioGroup,{row:!0,value:(n==null?void 0:n.alarmType)||"",onChange:(d,m)=>{const p=a.map(b=>b.uniqueName===h?{...b,alarmType:m}:b);this.setState({entries:p}),this.onChange(this.props.attr,p)},children:[e.jsx(t.FormControlLabel,{value:"alarm",control:e.jsx(t.Radio,{}),label:this.getText("unlock_alarm")}),e.jsx(t.FormControlLabel,{value:"unlock",control:e.jsx(t.Radio,{}),label:this.getText("unlock_unlock")})]})]})}),e.jsx(t.TextField,{fullWidth:!0,variant:"standard",type:"text",autoComplete:"off",label:this.getText("headline"),value:n.headline??"",onChange:d=>{const m=d.target.value,p=a.map(b=>b.uniqueName===h?{...b,headline:m}:b);this.setState({entries:p}),this.onChange(this.props.attr,p)},InputProps:{sx:{backgroundColor:"transparent",px:1,width:"50%"}},sx:{mb:2}}),e.jsx(t.Box,{sx:{mt:2},children:e.jsx(t.TextField,{variant:"standard",label:this.getText("unlock_pin"),type:s.showPin?"text":"password",value:n.pin!==void 0&&n.pin!==null?String(n.pin):"",onChange:d=>{const p=d.target.value.replace(/[^0-9]/g,""),b=p?parseInt(p,10):0,T=a.map(g=>g.uniqueName===h?{...g,pin:b}:g);this.setState({entries:T}),this.onChange(this.props.attr,T)},InputProps:{sx:{backgroundColor:"transparent",px:1},endAdornment:e.jsx(t.InputAdornment,{position:"end",children:e.jsx(t.IconButton,{"aria-label":s.showPin?"hide-pin":"show-pin",onClick:()=>{s.showPin=!s.showPin,this.setState({})},edge:"end",size:"small",children:s.showPin?e.jsx(G,{fontSize:"small"}):e.jsx(H,{fontSize:"small"})})})}})}),e.jsxs(t.Box,{sx:{mt:2},children:[e.jsx(t.FormControlLabel,{control:e.jsx(t.Checkbox,{checked:!!n.hidden,onChange:(d,m)=>{const p=a.map(b=>b.uniqueName===h?{...b,hidden:m}:b);this.setState({entries:p}),this.onChange(this.props.attr,p)}}),label:this.getText("hidden")}),e.jsx(t.Box,{sx:{mt:2},children:e.jsxs(t.FormControl,{component:"fieldset",children:[e.jsx(t.Typography,{variant:"subtitle2",sx:{mb:1},children:this.getText("alwaysOn")}),e.jsxs(t.RadioGroup,{row:!0,value:(n==null?void 0:n.alwaysOn)||"none",onChange:(d,m)=>{const p=a.map(b=>b.uniqueName===h?{...b,alwaysOn:m}:b);this.setState({entries:p}),this.onChange(this.props.attr,p)},children:[e.jsx(t.FormControlLabel,{value:"none",control:e.jsx(t.Radio,{}),label:this.getText("alwaysOn_none")}),e.jsx(t.FormControlLabel,{value:"always",control:e.jsx(t.Radio,{}),label:this.getText("alwaysOn_always")}),e.jsx(t.FormControlLabel,{value:"ignore",control:e.jsx(t.Radio,{}),label:this.getText("alwaysOn_ignore")})]})]})})]}),n.alarmType==="alarm"&&e.jsxs(t.Box,{sx:{mt:2},children:[e.jsxs(t.Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:2},children:[e.jsxs(t.Box,{children:[e.jsx(t.Typography,{variant:"subtitle2",sx:{mb:1},children:this.getText("unlock_armed_header")}),e.jsx(t.Box,{sx:{display:"grid",gap:2},children:[1,2,3,4].map(d=>{const m=`button${d}`,p=(d-1)%4+1;return e.jsxs(t.Box,{children:[e.jsx(t.Typography,{variant:"caption",color:"text.secondary",sx:{mb:.5},children:this.getText(`unlock_button${p}_label`)}),e.jsx(t.TextField,{fullWidth:!0,variant:"standard",placeholder:this.getText(`unlock_button${p}_placeholder`),value:n[m]??"",onChange:b=>{const T=b.target.value,g=a.map(x=>x.uniqueName===h?{...x,[m]:T}:x);this.setState({entries:g}),this.onChange(this.props.attr,g)},InputProps:{disableUnderline:!0,sx:{backgroundColor:"transparent",px:1,"& input::placeholder":{color:"text.disabled"}}}})]},d)})})]}),e.jsxs(t.Box,{children:[e.jsx(t.Typography,{variant:"subtitle2",sx:{mb:1},children:this.getText("unlock_disarmed_header")}),e.jsx(t.Box,{sx:{display:"grid",gap:2},children:[5,6,7,8].map(d=>{const m=`button${d}`,p=(d-1)%4+1;return e.jsxs(t.Box,{children:[e.jsx(t.Typography,{variant:"caption",color:"text.secondary",sx:{mb:.5},children:this.getText(`unlock_button${p}_label`)}),e.jsx(t.TextField,{fullWidth:!0,variant:"standard",placeholder:this.getText(`unlock_button${p}_placeholder`),value:n[m]??"",onChange:b=>{const T=b.target.value,g=a.map(x=>x.uniqueName===h?{...x,[m]:T}:x);this.setState({entries:g}),this.onChange(this.props.attr,g)},InputProps:{disableUnderline:!0,sx:{backgroundColor:"transparent",px:1,"& input::placeholder":{color:"text.disabled"}}}})]},d)})})]})]}),e.jsx(t.Box,{sx:{mt:1},children:e.jsx(t.FormControlLabel,{control:e.jsx(t.Checkbox,{checked:!!n.approved,onChange:(d,m)=>{const p=a.map(b=>b.uniqueName===h?{...b,approved:m}:b);this.setState({entries:p}),this.onChange(this.props.attr,p)}}),label:this.getText("unlock_approved")})})]}),n.alarmType==="unlock"&&e.jsxs(t.Box,{sx:{mt:2},children:[e.jsx(t.Typography,{variant:"caption",color:"text.secondary",sx:{mb:.5},children:this.getText("unlock_setnavi_hint")}),e.jsxs(t.Select,{variant:"standard",displayEmpty:!0,value:n.setNavi??"",onChange:d=>{const m=String(d.target.value),p=a.map(b=>b.uniqueName===h?{...b,setNavi:m}:b);this.setState({entries:p}),this.onChange(this.props.attr,p)},sx:{backgroundColor:"transparent",px:1,width:"60%"},children:[e.jsx(t.MenuItem,{value:"",children:e.jsx("em",{children:this.getText("unlock_setnavi_placeholder")})}),(this.state.pagesList||[]).filter(d=>typeof d=="string"&&!d.startsWith("///")&&d!==h).map(d=>e.jsx(t.MenuItem,{value:d,children:d},d)),n.setNavi&&n.setNavi!==h&&!(this.state.pagesList||[]).includes(n.setNavi)&&e.jsx(t.MenuItem,{value:n.setNavi,children:n.setNavi},`custom-${n.setNavi}`)]})]})]}):null})()}):e.jsxs(t.Box,{children:[e.jsx(t.Typography,{variant:"h6",children:this.getText("select_item")}),e.jsx(t.Box,{sx:{mt:2},children:e.jsx(t.Typography,{variant:"body2",color:"text.secondary",children:this.getText("select_description")})})]})})}),e.jsx(q,{...this.props,widthPercent:30,uniqueName:s.selected,currentAssignments:((w=a.find(h=>h.uniqueName===s.selected))==null?void 0:w.navigationAssignment)||[],oContext:this.props.oContext,onAssign:(h,n)=>{const d=a.map(m=>m.uniqueName===h?{...m,navigationAssignment:n}:m);this.setState({entries:d}),this.onChange(this.props.attr,d)}})]})]})}}const J=F(Q);class K extends k.ConfigGeneric{_local=null;pagesRetryTimeout;dateFormats=[{value:{dateStyle:"short"},label:"DD.MM.YY"},{value:{dateStyle:"short",locale:"en-US"},label:"MM/DD/YY"},{value:{year:"numeric",month:"2-digit",day:"2-digit"},label:"YYYY-MM-DD"},{value:{day:"2-digit",month:"short",year:"numeric"},label:"DD MMM YYYY"},{value:{day:"2-digit",month:"long",year:"numeric"},label:"DD Month YYYY"},{value:{weekday:"short",day:"2-digit",month:"2-digit",year:"numeric"},label:"EEE, DD.MM.YYYY"},{value:{weekday:"long",day:"2-digit",month:"2-digit",year:"numeric"},label:"EEEE, DD.MM.YYYY"},{value:{weekday:"short",day:"2-digit",month:"short",year:"numeric"},label:"EEE, DD MMM YYYY"},{value:{weekday:"long",day:"2-digit",month:"long",year:"numeric"},label:"EEEE, DD Month YYYY"},{value:"custom",label:"Custom"}];timeFormats=[{value:"HH:mm",label:"timeFormat24"},{value:"h:mm a",label:"timeFormat12"},{value:"HH:mm:ss",label:"timeFormat24Seconds"},{value:"h:mm:ss a",label:"timeFormat12Seconds"},{value:"custom",label:"Custom"}];constructor(i){super(i);const r=k.ConfigGeneric.getValue(i.data,i.attr);this.state={...this.state,entries:Array.isArray(r)?r:[],confirmDeleteOpen:!1,confirmDeleteName:null,alive:!1,pagesRetryCount:0}}formatDatePreview(i,r){try{return i.toLocaleDateString(void 0,typeof r=="string"?JSON.parse(r):r)}catch{return"Invalid Format"}}formatTimePreview(i,r){return r.replace(/HH/g,String(i.getHours()).padStart(2,"0")).replace(/mm/g,String(i.getMinutes()).padStart(2,"0")).replace(/ss/g,String(i.getSeconds()).padStart(2,"0")).replace(/h/g,String(i.getHours()%12||12)).replace(/a/g,i.getHours()>=12?"PM":"AM")}componentWillUnmount(){this.pagesRetryTimeout&&clearTimeout(this.pagesRetryTimeout);const i=this.props.oContext.instance??"0";this.props.oContext.socket.unsubscribeState(`system.adapter.${P}.${i}.alive`,this.onAliveChanged)}async componentDidMount(){super.componentDidMount();const i=this.props.oContext.instance??"0",r=`system.adapter.${P}.${i}.alive`;try{const l=await this.props.oContext.socket.getState(r),a=!!(l!=null&&l.val);this.setState({alive:a}),await this.props.oContext.socket.subscribeState(r,this.onAliveChanged),a&&await this.loadPagesList()}catch(l){console.error("[ScreensaverPage] Failed to get alive state or subscribe:",l),this.setState({alive:!1})}}onAliveChanged=(i,r)=>{const l=this.state.alive,a=r?!!r.val:!1;l!==a&&(this.setState({alive:a}),!l&&a&&(!this.state.pagesList||this.state.pagesList.length===0)&&this.loadPagesList(),l&&!a&&this.pagesRetryTimeout&&(clearTimeout(this.pagesRetryTimeout),this.pagesRetryTimeout=void 0))};async loadPagesList(){if(!this.state.alive){console.log("[ScreensaverPage] Adapter not alive, skipping pages load");return}const i=[];if(this.props.oContext&&this.props.oContext.socket){const r=this.props.oContext.instance??"0",l=`${P}.${r}`;try{const a=await this.props.oContext.socket.sendTo(l,B,null);let c=[];Array.isArray(a)?c=a:a&&Array.isArray(a.result)&&(c=a.result);for(const s of c)i.push(s);if(c.length===0){const s=this.state.pagesRetryCount||0,o=3e3;console.log(`[ScreensaverPage] Got empty pages array, retrying in ${o}ms (attempt ${s+1})`),this.setState({pagesRetryCount:s+1}),this.pagesRetryTimeout&&clearTimeout(this.pagesRetryTimeout),this.pagesRetryTimeout=setTimeout(()=>{this.state.alive?this.loadPagesList():console.log("[ScreensaverPage] Adapter went offline, cancelling pages retry")},o);return}else c.length>0&&(console.log(`[ScreensaverPage] Successfully loaded ${c.length} pages after ${this.state.pagesRetryCount||0} retries`),this.setState({pagesRetryCount:0}),this.pagesRetryTimeout&&(clearTimeout(this.pagesRetryTimeout),this.pagesRetryTimeout=void 0))}catch(a){const c=this.state.pagesRetryCount||0,s=3e3;console.log(`[ScreensaverPage] Error loading pages, retrying in ${s}ms (attempt ${c+1}): ${String(a)}`),this.setState({pagesRetryCount:c+1}),this.pagesRetryTimeout&&clearTimeout(this.pagesRetryTimeout),this.pagesRetryTimeout=setTimeout(()=>{this.state.alive?this.loadPagesList():console.log("[ScreensaverPage] Adapter went offline, cancelling pages retry after error")},s);return}}else{console.log("[ScreensaverPage] No socket available for sendTo");return}this.setState({pagesList:Array.from(new Set(i))})}renderItem(i,r,l){var h,n,d,m,p,b,T,g,x,f,M,$;const a=this.state.entries||[],c=Array.from(new Set(a.map(u=>u.uniqueName))).filter(Boolean);this._local||(this._local={newName:"",selected:c[0]||""});const s=this._local,o=()=>{const u=(s.newName||"").trim();if(!u)return;const C={card:"screensaver",uniqueName:u,headline:u,type:"clock",enabled:!0,timeout:60},v=[...a,C];this.setState({entries:v}),this.onChange(this.props.attr,v),s.newName="",s.selected=u},y=()=>{const u=s.selected;u&&this.setState({confirmDeleteOpen:!0,confirmDeleteName:u})},_=()=>{this.setState({confirmDeleteOpen:!1,confirmDeleteName:null})},w=()=>{const u=this.state.confirmDeleteName;if(!u){_();return}const C=a.filter(j=>j.uniqueName!==u);this.setState({entries:C,confirmDeleteOpen:!1,confirmDeleteName:null}),this.onChange(this.props.attr,C);const v=Array.from(new Set(C.map(j=>j.uniqueName))).filter(Boolean);s&&(s.selected=v[0]||""),this.setState({})};return e.jsxs(t.Box,{sx:{height:"calc(100vh - 64px)",display:"flex",flexDirection:{xs:"column",md:"row"},p:1},children:[e.jsxs(t.Box,{sx:{width:{xs:"100%",md:"20%"},pr:{xs:0,md:1},display:"flex",flexDirection:"column",gap:1},children:[e.jsx(t.Typography,{variant:"h6",sx:{mb:1,fontWeight:600,color:"primary.main",fontSize:"1rem"},children:this.getText("screensaver_pages")}),e.jsx(t.Paper,{sx:{p:1,backgroundColor:"transparent"},elevation:0,children:e.jsxs(t.Box,{sx:{display:"flex",gap:1},children:[e.jsx(t.TextField,{"aria-label":"new-screensaver-name",label:this.getText("new_screensaver"),value:(s==null?void 0:s.newName)||"",onChange:u=>{s&&(s.newName=u.target.value),this.setState({})},variant:"standard",placeholder:this.getText("new_screensaver"),InputProps:{sx:{backgroundColor:"transparent",px:1}},sx:{flex:1,"& .MuiInput-underline:before":{borderBottomColor:"primary.main"},"& .MuiInput-underline:hover:before":{borderBottomColor:"primary.main"},"& .MuiInput-underline:after":{borderBottomColor:"primary.main"},"& .MuiInputLabel-root":{color:"primary.main"},"& .MuiInputLabel-root.Mui-focused":{color:"primary.main"}}}),e.jsx(t.Button,{size:"small",variant:"contained",onClick:o,sx:{minWidth:32,padding:"4px 8px"},disabled:(()=>{const u=((s==null?void 0:s.newName)||"").trim();return!u||c.includes(u)})(),children:"+"})]})}),e.jsx(t.Paper,{sx:{overflow:"auto",p:1,backgroundColor:"transparent"},elevation:1,children:c.length===0?e.jsx(t.Typography,{variant:"body2",color:"text.secondary",children:this.getText("no_screensavers")}):c.map(u=>e.jsx(t.Box,{onClick:()=>{s&&(s.selected=u),this.setState({})},sx:{p:1,borderRadius:1,cursor:"pointer",backgroundColor:(s==null?void 0:s.selected)===u?"action.selected":"transparent",mb:.5},children:e.jsx(t.Typography,{variant:"body2",children:u})},u))}),e.jsx(t.Box,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(t.Button,{size:"small",color:"error",variant:"outlined",sx:{minWidth:32,padding:"4px 8px"},onClick:y,disabled:!(s!=null&&s.selected),children:"-"})}),e.jsx(t.Box,{sx:{marginTop:2,marginBottom:2},children:e.jsxs(t.FormControl,{component:"fieldset",disabled:(s==null?void 0:s.selected)===null,children:[e.jsx(t.FormLabel,{component:"legend",sx:{color:(s==null?void 0:s.selected)===null?((d=(n=(h=this.props.theme)==null?void 0:h.palette)==null?void 0:n.text)==null?void 0:d.disabled)||"#999":(b=(p=(m=this.props.theme)==null?void 0:m.palette)==null?void 0:p.text)==null?void 0:b.primary},children:this.getText("cardType")}),e.jsxs(t.RadioGroup,{value:s!=null&&s.selected&&((T=this.state.entries.find(u=>u.uniqueName===s.selected))==null?void 0:T.card)||"screensaver",onChange:u=>{if(s!=null&&s.selected){const C=u.target.value,v=[...this.state.entries],j=v.findIndex(S=>S.uniqueName===s.selected);j!==-1&&(v[j]={...v[j],card:C},this.setState({entries:v}),this.props.onChange(this.props.attr||"",v))}},sx:{flexDirection:"column","& .MuiRadio-root.Mui-disabled":{color:"#999 !important"},"& .MuiFormControlLabel-label.Mui-disabled":{color:"#999 !important"}},children:[e.jsx(t.FormControlLabel,{value:"screensaver",control:e.jsx(t.Radio,{}),label:this.getText("cardTypeStandard")}),e.jsx(t.FormControlLabel,{value:"screensaver2",control:e.jsx(t.Radio,{}),label:this.getText("cardTypeAdvanced")}),e.jsx(t.FormControlLabel,{value:"screensaver3",control:e.jsx(t.Radio,{}),label:this.getText("cardTypeEasyview")})]})]})}),e.jsx(t.Divider,{sx:{my:1}}),e.jsx(t.Box,{sx:{mb:2},children:e.jsx("a",{href:"https://github.com/ticaki/ioBroker.nspanel-lovelace-ui/wiki/screensaver",target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none",color:"inherit",fontSize:"0.875rem"},children:e.jsx(t.Typography,{variant:"body2",sx:{color:"primary.main",textDecoration:"underline",cursor:"pointer","&:hover":{opacity:.8}},children:this.getText("documentation")})})}),e.jsxs(t.Box,{sx:{mb:2},children:[e.jsx(t.Typography,{variant:"caption",sx:{display:"block",mb:1,color:"text.secondary"},children:"Test 1: SelectID Dialog (filterFunc = real function)"}),e.jsx(t.TextField,{fullWidth:!0,label:"Select Object ID (Dialog)",value:this.state.selectedObjectId||"",onClick:()=>{this.setState({showSelectDialog:!0})},InputProps:{readOnly:!0}}),this.state.showSelectDialog&&e.jsx(N.SelectID,{socket:this.props.oContext.socket,selected:this.state.selectedObjectId||"",onOk:u=>{const C=Array.isArray(u)?u[0]:u;this.setState({selectedObjectId:C||"",showSelectDialog:!1})},onClose:()=>{this.setState({showSelectDialog:!1})},filterFunc:u=>{var C;return!!((u==null?void 0:u.type)==="state"&&((C=u.common)!=null&&C.role)&&u.common.role.startsWith("switch"))},dialogName:"nspanel-screensaver",theme:this.props.theme,themeType:((x=(g=this.props.theme)==null?void 0:g.palette)==null?void 0:x.mode)||"light"})]}),e.jsxs(t.Box,{sx:{mb:2},children:[e.jsx(t.Typography,{variant:"caption",sx:{display:"block",mb:1,color:"text.secondary"},children:"Test 2: JsonConfigComponent (filterFunc = string compiled with new Function)"}),e.jsx(k.JsonConfigComponent,{socket:this.props.oContext.socket,themeName:this.props.themeName,themeType:((M=(f=this.props.theme)==null?void 0:f.palette)==null?void 0:M.mode)||"light",theme:this.props.theme,schema:{type:"panel",label:"Object Selector",items:{testObjectId:{type:"objectId",label:"Select Object (JsonConfig)",sm:12,md:12,lg:12,filterFunc:"return !!(obj?.type === 'state' && obj.common?.role && obj.common.role.startsWith('switch'));"}}},data:{testObjectId:this.state.selectedObjectIdJson||""},onChange:u=>{const C=u&&u.testObjectId||"";this.setState({selectedObjectIdJson:C})},isFloatComma:!1,dateFormat:"DD.MM.YYYY",onError:()=>{},adapterName:"nspanel-lovelace-ui",instance:Number((($=this.props.oContext)==null?void 0:$.instance)||0)})]})]}),e.jsx(L,{open:!!this.state.confirmDeleteOpen,onClose:_,onConfirm:w,title:this.getText("screensaver_delete_confirm_title"),description:this.getText("screensaver_delete_confirm_text")+(this.state.confirmDeleteName?`: ${this.state.confirmDeleteName}`:""),cancelText:this.getText("Cancel"),confirmText:this.getText("Delete"),ariaTitleId:"screensaver-delete-confirm-title",ariaDescId:"screensaver-delete-confirm-description"}),e.jsxs(t.Box,{sx:{width:{xs:"100%",md:"90%"},pl:{xs:0,md:2},mt:{xs:2,md:0},display:"flex",flexDirection:{xs:"column",md:"row"},gap:1,position:"relative"},children:[e.jsx(t.Box,{sx:{width:{xs:"100%",md:"95%"},borderLeft:{xs:"none",md:"1px solid"},borderColor:"divider"},children:e.jsx(t.Paper,{sx:{height:"100%",p:2},elevation:1,children:s!=null&&s.selected?e.jsx(t.Box,{children:(()=>{const u=s==null?void 0:s.selected,C=a.find(v=>v.uniqueName===u);return C?e.jsxs(t.Box,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(t.Typography,{variant:"h6",sx:{mb:1},children:[this.getText("screensaver_config"),": ",u]}),e.jsx(t.TextField,{label:this.getText("screensaver_headline"),value:C.headline||"",onChange:v=>{const j=a.map(S=>S.uniqueName===u?{...S,headline:v.target.value}:S);this.setState({entries:j}),this.onChange(this.props.attr,j)},variant:"outlined",fullWidth:!0}),e.jsx(t.TextField,{label:this.getText("screensaver_timeout"),value:C.timeout||60,onChange:v=>{const j=parseInt(v.target.value)||60,S=a.map(A=>A.uniqueName===u?{...A,timeout:j}:A);this.setState({entries:S}),this.onChange(this.props.attr,S)},variant:"outlined",type:"number",fullWidth:!0}),e.jsxs(t.FormControl,{variant:"outlined",fullWidth:!0,sx:{mt:2},children:[e.jsx(t.InputLabel,{children:this.getText("dateFormat")}),e.jsx(t.Select,{value:C.dateFormat||"dd.MM.yyyy",onChange:v=>{const j=v.target.value,S=a.map(A=>A.uniqueName===u?{...A,dateFormat:j}:A);this.setState({entries:S}),this.onChange(this.props.attr,S)},label:this.getText("dateFormat"),children:this.dateFormats.map(v=>e.jsx(t.MenuItem,{value:JSON.stringify(v.value),children:v.value==="custom"?this.getText("dateFormatCustom"):v.label},v.label))})]}),C.dateFormat==="custom"&&e.jsx(t.TextField,{label:this.getText("dateFormatCustom"),value:C.customDateFormat||"",onChange:v=>{const j=v.target.value,S=a.map(A=>A.uniqueName===u?{...A,customDateFormat:j}:A);this.setState({entries:S}),this.onChange(this.props.attr,S)},variant:"outlined",fullWidth:!0,placeholder:"dd.MM.yyyy",sx:{mt:1}}),e.jsxs(t.Typography,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:[this.getText("dateFormatExample"),":"," ",(()=>{const v=new Date,j=C.dateFormat||"dd.MM.yyyy";console.log("Formatting date with format:",C.dateFormat);try{if(j==="custom"){const S=C.customDateFormat||"";return S?this.formatDatePreview(v,S):"Enter custom format above"}return this.formatDatePreview(v,j)}catch{return"Invalid format"}})()]}),e.jsxs(t.FormControl,{variant:"outlined",fullWidth:!0,sx:{mt:2},children:[e.jsx(t.InputLabel,{children:this.getText("timeFormat")}),e.jsx(t.Select,{value:C.timeFormat||"HH:mm",onChange:v=>{const j=v.target.value,S=a.map(A=>A.uniqueName===u?{...A,timeFormat:j}:A);this.setState({entries:S}),this.onChange(this.props.attr,S)},label:this.getText("timeFormat"),children:this.timeFormats.map(v=>e.jsx(t.MenuItem,{value:v.value,children:v.value==="custom"?this.getText("timeFormatCustom"):this.getText(v.label)},v.value))})]}),C.timeFormat==="custom"&&e.jsx(t.TextField,{label:this.getText("timeFormatCustom"),value:C.customTimeFormat||"",onChange:v=>{const j=v.target.value,S=a.map(A=>A.uniqueName===u?{...A,customTimeFormat:j}:A);this.setState({entries:S}),this.onChange(this.props.attr,S)},variant:"outlined",fullWidth:!0,placeholder:"HH:mm",sx:{mt:1}}),e.jsxs(t.Typography,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:[this.getText("timeFormatExample"),":"," ",(()=>{const v=new Date,j=C.timeFormat||"HH:mm";try{if(j==="custom"){const S=C.customTimeFormat||"";return S?this.formatTimePreview(v,S):"Enter custom format above"}return this.formatTimePreview(v,j)}catch{return"Invalid format"}})()]})]}):e.jsx(t.Typography,{variant:"body2",color:"error",children:this.getText("screensaver_entry_not_found")})})()}):e.jsxs(t.Box,{children:[e.jsx(t.Typography,{variant:"h6",children:this.getText("screensaver_select_item")}),e.jsx(t.Box,{sx:{mt:2},children:e.jsx(t.Typography,{variant:"body2",color:"text.secondary",children:this.getText("screensaver_select_description")})})]})})}),e.jsx(q,{...this.props,widthPercent:30,oContext:this.props.oContext,uniqueName:(s==null?void 0:s.selected)||"",currentAssignments:(()=>{const u=s==null?void 0:s.selected;if(!u)return[];const C=a.find(v=>v.uniqueName===u);return(C==null?void 0:C.navigation)||[]})(),onAssign:(u,C)=>{const v=a.map(j=>j.uniqueName===u?{...j,navigation:C}:j);this.setState({entries:v}),this.onChange(this.props.attr,v)}})]})]})}}const X=F(K);class Z extends R.Component{schema;constructor(i){super(i),this.state={data:{objectId:i.value||""}};const r={type:"objectId",label:"Select an object",sm:12,md:12,lg:12,...this.props.objectIdConfig};this.schema={type:"panel",label:"Object Selector",items:{objectId:r}}}componentDidUpdate(i){i.value!==this.props.value&&this.props.value!==this.state.data.objectId&&this.setState({data:{objectId:this.props.value||""}})}handleChange=i=>{this.setState({data:i}),this.props.onChange&&i.objectId!==this.props.value&&this.props.onChange(i.objectId)};render(){const{socket:i,themeName:r,themeType:l,theme:a,adapterName:c,instance:s,showSelected:o}=this.props;return e.jsxs(t.Box,{sx:{width:"100%"},children:[e.jsx(k.JsonConfigComponent,{socket:i,themeName:r,themeType:l,theme:a,adapterName:c||"nspanel-lovelace-ui",instance:s||0,schema:this.schema,data:this.state.data,onChange:this.handleChange,isFloatComma:!1,dateFormat:"DD.MM.YYYY",onError:()=>{}}),o&&e.jsxs(t.Box,{sx:{mt:2,color:"text.secondary",fontSize:"0.875rem"},children:[N.I18n.t("Selected object"),": ",this.state.data.objectId||e.jsx("em",{children:"—"})]})]})}}class ee extends k.ConfigGeneric{_local=null;pagesRetryTimeout;constructor(i){super(i);const r=k.ConfigGeneric.getValue(i.data,i.attr);this.state={...this.state,entries:Array.isArray(r)?r:[],confirmDeleteOpen:!1,confirmDeleteName:null,alive:!1,pagesRetryCount:0}}componentWillUnmount(){this.pagesRetryTimeout&&clearTimeout(this.pagesRetryTimeout);const i=this.props.oContext.instance??"0";this.props.oContext.socket.unsubscribeState(`system.adapter.${P}.${i}.alive`,this.onAliveChanged)}async componentDidMount(){super.componentDidMount();const i=this.props.oContext.instance??"0",r=`system.adapter.${P}.${i}.alive`;try{const l=await this.props.oContext.socket.getState(r),a=!!(l!=null&&l.val);this.setState({alive:a}),await this.props.oContext.socket.subscribeState(r,this.onAliveChanged),a&&await this.loadPagesList()}catch(l){console.error("[QRPage] Failed to get alive state or subscribe:",l),this.setState({alive:!1})}}onAliveChanged=(i,r)=>{const l=this.state.alive,a=r?!!r.val:!1;l!==a&&(this.setState({alive:a}),!l&&a&&(!this.state.pagesList||this.state.pagesList.length===0)&&this.loadPagesList(),l&&!a&&this.pagesRetryTimeout&&(clearTimeout(this.pagesRetryTimeout),this.pagesRetryTimeout=void 0))};async loadPagesList(){if(!this.state.alive){console.log("[QRPage] Adapter not alive, skipping pages load");return}const i=[];if(this.props.oContext&&this.props.oContext.socket){const r=this.props.oContext.instance??"0",l=`${P}.${r}`;try{const a=await this.props.oContext.socket.sendTo(l,B,null);let c=[];Array.isArray(a)?c=a:a&&Array.isArray(a.result)&&(c=a.result);for(const s of c)i.push(s);if(c.length===0){const s=this.state.pagesRetryCount||0,o=3e3;console.log(`[QRPage] Got empty pages array, retrying in ${o}ms (attempt ${s+1})`),this.setState({pagesRetryCount:s+1}),this.pagesRetryTimeout&&clearTimeout(this.pagesRetryTimeout),this.pagesRetryTimeout=setTimeout(()=>{this.state.alive?this.loadPagesList():console.log("[QRPage] Adapter went offline, cancelling pages retry")},o);return}else c.length>0&&(console.log(`[QRPage] Successfully loaded ${c.length} pages after ${this.state.pagesRetryCount||0} retries`),this.setState({pagesRetryCount:0}),this.pagesRetryTimeout&&(clearTimeout(this.pagesRetryTimeout),this.pagesRetryTimeout=void 0))}catch(a){const c=this.state.pagesRetryCount||0,s=3e3;console.log(`[QRPage] Error loading pages, retrying in ${s}ms (attempt ${c+1}): ${String(a)}`),this.setState({pagesRetryCount:c+1}),this.pagesRetryTimeout&&clearTimeout(this.pagesRetryTimeout),this.pagesRetryTimeout=setTimeout(()=>{this.state.alive?this.loadPagesList():console.log("[QRPage] Adapter went offline, cancelling pages retry after error")},s);return}}else{console.log("[QRPage] No socket available for sendTo");return}this.setState({pagesList:Array.from(new Set(i))})}renderItem(i,r,l){var h;const a=this.state.entries||[],c=Array.from(new Set(a.map(n=>n.uniqueName))).filter(Boolean);this._local||(this._local={newName:"",selected:c[0]||"",showPassword:!1});const s=this._local,o=()=>{const n=(s.newName||"").trim();if(!n)return;const d={card:"cardQR",uniqueName:n,headline:n,SSIDURLTEL:"",wlanhidden:!1,pwdhidden:!1,setState:"",selType:0},m=[...a,d];this.setState({entries:m}),this.onChange(this.props.attr,m),s.newName="",s.selected=n},y=()=>{const n=s.selected;n&&this.setState({confirmDeleteOpen:!0,confirmDeleteName:n})},_=()=>{this.setState({confirmDeleteOpen:!1,confirmDeleteName:null})},w=()=>{const n=this.state.confirmDeleteName;if(!n){_();return}const d=a.filter(p=>p.uniqueName!==n);this.setState({entries:d,confirmDeleteOpen:!1,confirmDeleteName:null}),this.onChange(this.props.attr,d);const m=Array.from(new Set(d.map(p=>p.uniqueName))).filter(Boolean);s.selected=m[0]||"",this.setState({})};return e.jsxs(t.Box,{sx:{height:"calc(100vh - 64px)",display:"flex",flexDirection:{xs:"column",md:"row"},p:1},children:[e.jsxs(t.Box,{sx:{width:{xs:"100%",md:"20%"},pr:{xs:0,md:1},display:"flex",flexDirection:"column",gap:1},children:[e.jsx(t.Typography,{variant:"h6",sx:{mb:1,fontWeight:600,color:"primary.main",fontSize:"1rem"},children:this.getText("pages")}),e.jsx(t.Paper,{sx:{p:1,backgroundColor:"transparent"},elevation:0,children:e.jsxs(t.Box,{sx:{display:"flex",gap:1},children:[e.jsx(t.TextField,{"aria-label":"new-name",label:this.getText("new_page"),value:s.newName,onChange:n=>{s.newName=n.target.value,this.setState({})},variant:"standard",placeholder:this.getText("New item"),InputProps:{sx:{backgroundColor:"transparent",px:1}},sx:{flex:1,"& .MuiInput-underline:before":{borderBottomColor:"primary.main"},"& .MuiInput-underline:hover:before":{borderBottomColor:"primary.main"},"& .MuiInput-underline:after":{borderBottomColor:"primary.main"},"& .MuiInputLabel-root":{color:"primary.main"},"& .MuiInputLabel-root.Mui-focused":{color:"primary.main"}}}),e.jsx(t.Button,{size:"small",variant:"contained",onClick:o,disabled:(()=>{const n=(s.newName||"").trim();return!n||c.includes(n)})(),children:"+"})]})}),e.jsx(t.Paper,{sx:{overflow:"auto",p:1,backgroundColor:"transparent"},elevation:0,children:c.length===0?e.jsx(t.Typography,{variant:"body2",color:"text.secondary",children:this.getText("No items")}):c.map(n=>e.jsx(t.Box,{onClick:()=>{s.selected=n,this.setState({})},sx:{p:1,borderRadius:1,cursor:"pointer",backgroundColor:s.selected===n?"action.selected":"transparent",mb:.5},children:e.jsx(t.Typography,{variant:"body2",children:n})},n))}),e.jsx(t.Box,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(t.Button,{size:"small",color:"error",variant:"outlined",onClick:y,disabled:!s.selected,children:"-"})}),e.jsx(t.Divider,{sx:{my:1}}),e.jsx(t.Box,{sx:{mb:2},children:e.jsx("a",{href:"https://github.com/ticaki/ioBroker.nspanel-lovelace-ui/wiki/PageQR",target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none",color:"inherit",fontSize:"0.875rem"},children:e.jsx(t.Typography,{variant:"body2",sx:{color:"primary.main",textDecoration:"underline",cursor:"pointer","&:hover":{opacity:.8}},children:this.getText("documentation")})})})]}),e.jsx(L,{open:!!this.state.confirmDeleteOpen,onClose:_,onConfirm:w,title:this.getText("delete_confirm_title"),description:this.getText("delete_confirm_text")+(this.state.confirmDeleteName?`: ${this.state.confirmDeleteName}`:""),cancelText:this.getText("Cancel"),confirmText:this.getText("Delete"),ariaTitleId:"qr-delete-confirm-title",ariaDescId:"qr-delete-confirm-description"}),e.jsxs(t.Box,{sx:{width:{xs:"100%",md:"90%"},pl:{xs:0,md:2},mt:{xs:2,md:0},display:"flex",flexDirection:{xs:"column",md:"row"},gap:1,position:"relative"},children:[e.jsx(t.Box,{sx:{width:{xs:"100%",md:"95%"},borderLeft:{xs:"none",md:"1px solid"},borderColor:"divider"},children:e.jsx(t.Paper,{sx:{height:"100%",p:2},elevation:1,children:s.selected?e.jsx(t.Box,{children:(()=>{var m,p,b;const n=s.selected,d=a.find(T=>T.uniqueName===n);return d?e.jsxs(e.Fragment,{children:[e.jsx(t.Box,{sx:{mb:1,p:1,borderRadius:1,backgroundColor:"action.hover"},children:e.jsx(t.TextField,{fullWidth:!0,variant:"standard",type:"text",label:this.getText("unique_label"),value:n,onChange:T=>{const g=T.target.value;if(!g.trim())return;const x=a.map(f=>f.uniqueName===n?{...f,uniqueName:g}:f);this.setState({entries:x}),this.onChange(this.props.attr,x),s.selected=g},InputProps:{sx:{backgroundColor:"transparent",px:1,fontWeight:600,width:"50%"}}})}),e.jsx(t.Box,{sx:{mb:2},children:e.jsxs(t.FormControl,{component:"fieldset",children:[e.jsx(t.FormLabel,{component:"legend",children:this.getText("qr_type")}),e.jsxs(t.RadioGroup,{row:!0,value:d.selType??0,onChange:T=>{const g=parseInt(T.target.value,10),x=a.map(f=>f.uniqueName===n?{...f,selType:g}:f);this.setState({entries:x}),this.onChange(this.props.attr,x)},children:[e.jsx(t.FormControlLabel,{value:1,control:e.jsx(t.Radio,{}),label:this.getText("qr_type_wifi")}),e.jsx(t.FormControlLabel,{value:2,control:e.jsx(t.Radio,{}),label:this.getText("qr_type_url")}),e.jsx(t.FormControlLabel,{value:3,control:e.jsx(t.Radio,{}),label:this.getText("qr_type_tel")})]})]})}),e.jsx(t.TextField,{fullWidth:!0,variant:"standard",type:"text",autoComplete:"off",label:this.getText("headline"),value:d.headline??"",onChange:T=>{const g=T.target.value,x=a.map(f=>f.uniqueName===n?{...f,headline:g}:f);this.setState({entries:x}),this.onChange(this.props.attr,x)},InputProps:{sx:{backgroundColor:"transparent",px:1,width:"50%"}},sx:{mb:2}}),e.jsx(t.TextField,{fullWidth:!0,variant:"standard",type:"text",autoComplete:"off",label:(()=>{switch(d.selType){case 1:return this.getText("qr_content_wifi");case 2:return this.getText("qr_content_url");case 3:return this.getText("qr_content_tel");default:return this.getText("qr_content")}})(),value:d.SSIDURLTEL??"",onChange:T=>{const g=T.target.value,x=a.map(f=>f.uniqueName===n?{...f,SSIDURLTEL:g}:f);this.setState({entries:x}),this.onChange(this.props.attr,x)},InputProps:{sx:{backgroundColor:"transparent",px:1}},sx:{mb:2}}),d.selType===1&&e.jsxs(t.Box,{sx:{mb:2},children:[e.jsxs(t.FormControl,{variant:"standard",sx:{mb:2,minWidth:120},children:[e.jsx(t.InputLabel,{children:this.getText("qr_wlan_type")}),e.jsxs(t.Select,{value:d.wlantype??"WPA2",onChange:T=>{const g=T.target.value,x=a.map(f=>f.uniqueName===n?{...f,wlantype:g}:f);this.setState({entries:x}),this.onChange(this.props.attr,x)},children:[e.jsx(t.MenuItem,{value:"nopass",children:"No Password"}),e.jsx(t.MenuItem,{value:"WPA",children:"WPA"}),e.jsx(t.MenuItem,{value:"WPA2",children:"WPA2"}),e.jsx(t.MenuItem,{value:"WPA3",children:"WPA3"}),e.jsx(t.MenuItem,{value:"WEP",children:"WEP"})]})]}),d.wlantype!=="nopass"&&e.jsx(t.TextField,{fullWidth:!0,variant:"standard",type:s.showPassword?"text":"password",label:this.getText("qr_password"),value:d.qrPass??"",onChange:T=>{const g=T.target.value,x=a.map(f=>f.uniqueName===n?{...f,qrPass:g}:f);this.setState({entries:x}),this.onChange(this.props.attr,x)},InputProps:{sx:{backgroundColor:"transparent",px:1},endAdornment:e.jsx(t.InputAdornment,{position:"end",children:e.jsx(t.IconButton,{"aria-label":"toggle password visibility",onClick:()=>{s.showPassword=!s.showPassword,this.setState({})},edge:"end",children:s.showPassword?e.jsx(W.VisibilityOff,{}):e.jsx(W.Visibility,{})})})},sx:{mb:2}}),e.jsxs(t.Box,{sx:{display:"flex",gap:2},children:[e.jsx(t.FormControlLabel,{control:e.jsx(t.Checkbox,{checked:!!d.wlanhidden,onChange:(T,g)=>{const x=a.map(f=>f.uniqueName===n?{...f,wlanhidden:g}:f);this.setState({entries:x}),this.onChange(this.props.attr,x)}}),label:this.getText("qr_wlan_hidden")}),e.jsx(t.FormControlLabel,{control:e.jsx(t.Checkbox,{checked:!!d.pwdhidden,onChange:(T,g)=>{const x=a.map(f=>f.uniqueName===n?{...f,pwdhidden:g}:f);this.setState({entries:x}),this.onChange(this.props.attr,x)}}),label:this.getText("qr_pwd_hidden")})]}),e.jsxs(t.Box,{sx:{mb:2},children:[e.jsx(t.Typography,{variant:"body2",sx:{mb:1,color:"text.secondary"},children:this.getText("qr_set_state")}),e.jsx(Z,{value:d.setState??"",onChange:T=>{const g=a.map(x=>x.uniqueName===n?{...x,setState:T}:x);this.setState({entries:g}),this.onChange(this.props.attr,g)},socket:this.props.oContext.socket,themeName:this.props.themeName,themeType:((p=(m=this.props.theme)==null?void 0:m.palette)==null?void 0:p.mode)||"light",theme:this.props.theme,adapterName:"nspanel-lovelace-ui",instance:((b=this.props.oContext)==null?void 0:b.instance)||0,objectIdConfig:{types:"state",filterFunc:"return !!(obj && obj.type === 'state' && obj.common && obj.common.type === 'boolean' && obj.common.write && obj.common.read);"}})]})]}),e.jsxs(t.Box,{sx:{mt:2},children:[e.jsx(t.FormControlLabel,{control:e.jsx(t.Checkbox,{checked:!!d.hidden,onChange:(T,g)=>{const x=a.map(f=>f.uniqueName===n?{...f,hidden:g}:f);this.setState({entries:x}),this.onChange(this.props.attr,x)}}),label:this.getText("hidden")}),e.jsx(t.Box,{sx:{mt:2},children:e.jsxs(t.FormControl,{component:"fieldset",children:[e.jsx(t.Typography,{variant:"subtitle2",sx:{mb:1},children:this.getText("alwaysOn")}),e.jsxs(t.RadioGroup,{row:!0,value:(d==null?void 0:d.alwaysOn)||"none",onChange:(T,g)=>{const x=a.map(f=>f.uniqueName===n?{...f,alwaysOn:g}:f);this.setState({entries:x}),this.onChange(this.props.attr,x)},children:[e.jsx(t.FormControlLabel,{value:"none",control:e.jsx(t.Radio,{}),label:this.getText("alwaysOn_none")}),e.jsx(t.FormControlLabel,{value:"always",control:e.jsx(t.Radio,{}),label:this.getText("alwaysOn_always")}),e.jsx(t.FormControlLabel,{value:"ignore",control:e.jsx(t.Radio,{}),label:this.getText("alwaysOn_ignore")})]})]})})]})]}):null})()}):e.jsxs(t.Box,{children:[e.jsx(t.Typography,{variant:"h6",children:this.getText("select_item")}),e.jsx(t.Box,{sx:{mt:2},children:e.jsx(t.Typography,{variant:"body2",color:"text.secondary",children:this.getText("select_description")})})]})})}),e.jsx(q,{...this.props,widthPercent:30,uniqueName:s.selected,currentAssignments:((h=a.find(n=>n.uniqueName===s.selected))==null?void 0:h.navigationAssignment)||[],oContext:this.props.oContext,onAssign:(n,d)=>{const m=a.map(p=>p.uniqueName===n?{...p,navigationAssignment:d}:p);this.setState({entries:m}),this.onChange(this.props.attr,m)}})]})]})}}const te=F(ee),ve={NavigationView:U,IconSelect:V,IconOverview:z,UnlockPage:J,ScreensaverPage:X,pageQR:te};export{ve as default};
